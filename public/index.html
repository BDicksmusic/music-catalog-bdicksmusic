<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Music Catalog</title>
    <link rel="stylesheet" href="variables.css"> 
    <link rel="stylesheet" href="styles.css">
    <style>
        html, body {
      scroll-behavior: smooth;
            margin: 0;
            padding: 0;
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        * {
            box-sizing: border-box;
    }
    @keyframes pulse-glow {
        0%, 100% { 
            opacity: 0.85; 
            transform: scale(1);
        }
        50% { 
            opacity: .98; 
            transform: scale(1.03);
        }
    }
    @keyframes fadeInUp {
        0% {
            opacity: 0;
            transform: translateY(20px);
        }
        100% {
            opacity: 1;
            transform: translateY(0);
        }
    }
    @keyframes subtleShimmer {
        0% {
            background-position: -200% 0, 0 0;
        }
        100% {
            background-position: 200% 0, 0 0;
        }
    }

    /* Section Borders for Visual Separation */
    .highlights-section {
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        margin-bottom: 0;
        padding-bottom: 4rem;
    }

    .section-showcase {
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
        margin-bottom: 0;
        padding-bottom: 4rem;
    }

    .section-showcase.alt-bg {
        border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    }

    .testimonials-section {
        border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        margin-bottom: 0;
        padding-bottom: 4rem;
    }

    .cta-section {
        border-top: 1px solid rgba(0, 0, 0, 0.06);
        margin-top: 0;
        padding-top: 4rem;
    }

    /* Responsive borders for mobile */
    @media (max-width: 768px) {
        .highlights-section,
        .section-showcase,
        .testimonials-section,
        .cta-section {
            border-width: 0.5px;
            padding-bottom: 3rem;
        }
        
        .cta-section {
            padding-top: 3rem;
        }
    }
    /* Explore Button Styles */
    .explore-btn {
        display: inline-block;
        color: var(--gray-100);
        font-size: 25px;
        background: var(--primary-400);
        font-weight: 900;
        text-decoration: none;
        cursor: pointer;
        border-radius: 50px;
        padding: 7px 10px;
        border: 1px solid var(--primary-400);
        box-shadow: 0 4px 10px rgba(0,0,0,0.13);
        position: relative;
        overflow: hidden;
        z-index: 10;
        pointer-events: auto;
        
        /* Initial hidden state for animation */
        opacity: 0;
        transform: translateY(20px);
        
        /* Animation sequence */
        animation: 
            fadeInUp 0.8s ease-out 0.6s forwards,
            pulse-glow 6.5s infinite 2s;
    }
    
    .explore-btn:hover { 
        color: var(--gray-100);
        background: 
            linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.3) 20%,
                rgba(255, 255, 255, 0.6) 50%,
                rgba(255, 255, 255, 0.3) 80%,
                transparent 100%
            ),
            var(--primary-500);
        background-size: 200% 100%, 100% 100%;
        border-color: var(--primary-500);
        box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        
        /* Only pause pulse animation, keep fadeInUp intact, add shimmer */
        animation: 
            fadeInUp 0.8s ease-out 0.6s forwards,
            pulse-glow 6.5s infinite 2s paused,
            subtleShimmer 4s linear infinite;
            
        /* Override transform for hover effect */
        transform: scale(1.05) translateY(-1px) !important;
        transition: border-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    }
    @media (max-width: 768px) {
        .explore-btn {
            font-size: 18px;
            padding: 8px 16px;
        }
    }



    .explore-btn.secondary {
        background: rgba(255, 255, 255, 0.2);
        color: var(--gray-100);
        border: 2px solid rgba(255, 255, 255, 0.4);
        backdrop-filter: blur(10px);
        font-size: 1rem;
        padding: 0.75rem 2rem;
        min-width: 200px;
        position: relative;
        z-index: 25;
        text-decoration: none;
        display: inline-block;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        transform: translateY(0);
        pointer-events: auto;
    }

    .explore-btn.secondary:hover {
        background: rgba(255, 255, 255, 0.4);
        border-color: rgba(255, 255, 255, 0.9);
        transform: scale(1.08) translateY(-3px) !important;
        box-shadow: 0 8px 20px rgba(255, 255, 255, 0.3), 0 4px 12px rgba(0, 0, 0, 0.2);
        color: var(--gray-100);
    }

    .explore-btn.secondary:active {
        transform: scale(1.05) translateY(-1px) !important;
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.2);
    }
    /* Hero Video Styles */
    .hero-video {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 1;
        opacity: 0;
        transition: opacity 0.8s ease;
    }

    .hero-video.loaded {
        opacity: 1;
    }

    .hero-fallback-image {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: 2;
        opacity: 1;
        transition: all 0.8s ease;
        filter: brightness(0.8);
    }

    .hero-fallback-image.hidden {
        opacity: 0;
        z-index: 1 !important;
        transform: scale(0.98);
        visibility: hidden;
        pointer-events: none;
    }

    .hero-fallback-image.active {
        opacity: 1;
        z-index: 2 !important;
        transform: scale(1);
        visibility: visible;
        pointer-events: auto;
    }

    .works-grid.dragging {
        cursor: grabbing;
        user-select: none;
    }
    .works-grid {
        display: flex;
        flex-direction: row;
        overflow-x: auto !important;
        overflow-y: hidden;
        gap: var(--space-5);
        padding: 0;
        width: 100vw;
        max-width: 100vw;
        min-width: 100vw;
        scroll-behavior: smooth;
        cursor: grab;
    }

    /* Dynamic Hero Styles */
    .hero-content-dynamic {
        max-width: 800px;
        margin: 0 auto;
        padding: 0 2rem;
    }

    .hero-main-title {
        font-size: 2.5rem;
        font-weight: 900;
        color: var(--gray-100);
        margin-bottom: 1.5rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        letter-spacing: 2px;
    }

    .hero-rotating-content {
        position: relative;
        min-height: 200px;
        height: 200px;
        margin-bottom: 2rem;
        overflow: hidden;
        width: 100%;
        display: block;
    }

    .hero-role {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        opacity: 0;
        transform: translateY(20px);
        transition: all 0.6s ease;
        text-align: center;
        min-height: 200px;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        pointer-events: none;
        z-index: 1;
    }

    .hero-role.active {
        opacity: 1 !important;
        transform: translateY(0) !important;
        pointer-events: auto !important;
        z-index: 2 !important;
    }

    /* Enhanced role transitions - all roles slide in from different directions but end up in the same spot */
    .hero-role[data-role="composer"]:not(.active) {
        transform: translateX(-100px) translateY(0);
        opacity: 0;
        pointer-events: none;
    }

    .hero-role[data-role="trumpeter"]:not(.active) {
        transform: translateX(100px) translateY(0);
        opacity: 0;
        pointer-events: none;
    }

    .hero-role[data-role="educator"]:not(.active) {
        transform: translateY(60px);
        opacity: 0;
        pointer-events: none;
    }

    .hero-role-title {
        font-size: 2rem;
        font-weight: 700;
        color: var(--gray-100);
        margin-bottom: 1rem;
        text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }

    .hero-role-description {
        font-size: 1.1rem;
        color: var(--gray-200);
        margin-bottom: 2rem;
        line-height: 1.6;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    .hero-nav-dots {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-top: 1.5rem;
        position: relative;
        z-index: 10;
    }

    .dot {
        width: 40px;
        height: 4px;
        border-radius: 2px;
        border: none;
        background: rgba(255, 255, 255, 0.3);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        position: relative;
        overflow: hidden;
        z-index: 20;
        transform: scaleX(1);
    }

    .dot.active {
        background: rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
        transform: scaleX(1.1);
    }

    .dot:hover {
        background: rgba(255, 255, 255, 0.7);
        transform: scaleX(1.3) scaleY(1.2);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
    }

    .dot:active {
        transform: scaleX(1.2) scaleY(1.1);
        background: rgba(255, 255, 255, 0.8);
    }

    .dot::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
        transition: left 0.5s ease;
    }

    .dot:hover::before {
        left: 100%;
    }

    @media (max-width: 768px) {
        .hero-main-title {
            font-size: 2rem;
        }
        
        .hero-role-title {
            font-size: 1.5rem;
        }
        
        .hero-role-description {
            font-size: 1rem;
        }
        
        .hero-content-dynamic {
            padding: 0 1rem;
        }

        .hero-nav-dots {
            gap: 0.75rem;
        }

        .dot {
            width: 30px;
            height: 3px;
        }
    }

     /* Section Styles */
     .section-showcase {
         padding: 4rem 0;
         background: var(--gray-50);
     }

     .section-showcase.alt-bg {
         background: var(--gray-100);
     }

     .section-header {
         text-align: center;
         margin-bottom: 3rem;
     }

     .section-title {
         font-size: 2.5rem;
         font-weight: 700;
         margin-bottom: 1rem;
         color: var(--gray-900);
     }

     .section-subtitle {
         font-size: 1.1rem;
         color: var(--gray-600);
         max-width: 600px;
         margin: 0 auto;
         line-height: 1.6;
     }

     /* Enhanced Catalog Highlights Section */
     .catalog-highlights-grid {
         display: flex;
         grid-template-columns: 2fr 1fr;
         gap: 3rem;
         align-items: start;
        width: 96%;
         margin: 0 auto;
     }

     .featured-composition {
         background: white;
         border-radius: 16px;
         overflow: hidden;
         box-shadow: 0 10px 30px rgba(0,0,0,0.1);
         transition: transform 0.3s ease, box-shadow 0.3s ease;
         display: flex;
         min-height: 400px;
     }

     .featured-composition:hover {
         transform: translateY(-5px);
         box-shadow: 0 20px 40px rgba(0,0,0,0.15);
     }

     .featured-composition-image {
         flex: 1;
         position: relative;
         overflow: hidden;
         min-height: 400px;
     }

     .composition-highlight-img {
         width: 100%;
         height: 100%;
         object-fit: cover;
         transition: transform 0.3s ease;
     }

     .featured-composition:hover .composition-highlight-img {
         transform: scale(1.05);
     }

     /* Audio Preview Overlay */
     .audio-preview-overlay {
         position: absolute;
         top: 0;
         left: 0;
         right: 0;
         bottom: 0;
         background: linear-gradient(45deg, rgba(0,0,0,0.3), rgba(0,0,0,0.1));
         display: flex;
         align-items: center;
         justify-content: center;
         opacity: 0;
         transition: opacity 0.3s ease;
     }

     .featured-composition:hover .audio-preview-overlay {
         opacity: 1;
     }

     .preview-play-btn {
         background: rgba(255, 255, 255, 0.9);
         border: none;
         border-radius: 50px;
         padding: 1rem 1.5rem;
         display: flex;
         align-items: center;
         gap: 0.5rem;
         font-weight: 600;
         color: var(--gray-900);
         cursor: pointer;
         transition: all 0.3s ease;
         backdrop-filter: blur(10px);
         box-shadow: 0 4px 12px rgba(0,0,0,0.15);
     }

     .preview-play-btn:hover {
         background: white;
         transform: scale(1.05);
         box-shadow: 0 6px 20px rgba(0,0,0,0.2);
     }

     .play-icon {
         font-size: 1.2rem;
         color: var(--primary-500);
     }

     .featured-composition-content {
         flex: 1;
         padding: 2.5rem;
         display: flex;
         flex-direction: column;
         justify-content: space-between;
     }

     .composition-header {
         margin-bottom: 1.5rem;
     }

     .featured-title {
         font-size: 1.8rem;
         font-weight: 700;
         margin-bottom: 1rem;
         color: var(--gray-900);
         line-height: 1.3;
     }

     .composition-badges {
         display: flex;
         gap: 0.5rem;
         flex-wrap: wrap;
     }

     .difficulty-badge {
         background: var(--primary-100);
         color: var(--primary-700);
         padding: 0.25rem 0.75rem;
         border-radius: 20px;
         font-size: 0.85rem;
         font-weight: 600;
     }

     .year-badge {
         background: var(--gray-100);
         color: var(--gray-700);
         padding: 0.25rem 0.75rem;
         border-radius: 20px;
         font-size: 0.85rem;
         font-weight: 600;
     }

     .featured-instrumentation {
         font-size: 1.1rem;
         color: var(--primary-600);
         font-weight: 600;
         margin-bottom: 1rem;
     }

     .featured-description {
         color: var(--gray-600);
         line-height: 1.6;
         margin-bottom: 1.5rem;
         flex-grow: 1;
     }

     /* Audio Player Styling */
     .composition-audio-preview {
         margin-bottom: 1.5rem;
         padding: 1rem;
         background: var(--gray-50);
         border-radius: 12px;
         border: 1px solid var(--gray-200);
     }

     .composition-audio-preview audio {
         width: 100%;
         height: 40px;
         border-radius: 8px;
     }

         .primary-actions-container {
        display: flex;
        gap: 1rem;
        margin-bottom: 1rem;
    }

    .primary-actions-container .btn-buy,
    .primary-actions-container .btn-primary {
        flex: 1;
        min-height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.85rem;
        font-weight: 500;
        padding: 0.5rem 1rem;
        border-radius: 6px;
        border: 1px solid;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        white-space: nowrap;
    }

    .primary-actions-container .btn-buy {
        background: var(--primary-500);
        color: white;
        border-color: var(--primary-500);
    }

    .primary-actions-container .btn-buy:hover {
        background: var(--primary-600);
        border-color: var(--primary-600);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.2);
    }
    
    /* Disabled Buy Now button styling */
    .primary-actions-container .btn-buy[style*="opacity: 0.6"] {
        background: var(--gray-300);
        border-color: var(--gray-400);
        color: var(--gray-600);
        cursor: not-allowed;
        transform: none;
    }
    
    .primary-actions-container .btn-buy[style*="opacity: 0.6"]:hover {
        background: var(--gray-300);
        border-color: var(--gray-400);
        color: var(--gray-600);
        transform: none;
        box-shadow: none;
    }

    .primary-actions-container .btn-primary {
        background: transparent;
        color: var(--primary-600);
        border-color: var(--primary-500);
    }

    .primary-actions-container .btn-primary:hover {
        background: var(--primary-50);
        color: var(--primary-700);
        border-color: var(--primary-600);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);
    }

    .buy-now-container {
        margin-bottom: 1rem;
    }

     .composition-actions {
         display: flex;
         gap: 1rem;
         flex-wrap: wrap;
     }

     .composition-actions .btn-primary {
         flex: 1;
         min-width: 140px;
         text-align: center;
     }

     .composition-actions .btn-secondary {
         flex: 1;
         min-width: 140px;
         text-align: center;
         background: transparent;
         color: var(--gray-700);
         border: 2px solid var(--gray-300);
     }

     .composition-actions .btn-secondary:hover {
         background: var(--gray-100);
         border-color: var(--gray-400);
     }

     /* Enhanced Stats Section */
     .catalog-stats {
         display: flex;
         flex-direction: column;
         gap: 1.5rem;
         background: white;
         padding: 2rem;
         border-radius: 16px;
         box-shadow: 0 10px 30px rgba(0,0,0,0.1);
         height: fit-content;
     }
     
     /* Horizontal Stats Layout */
     .catalog-stats-horizontal {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
         gap: 2rem;
         max-width: 1200px;
         margin: 0 auto;
     }

     .stats-header {
         text-align: center;
         margin-bottom: 1rem;
         padding-bottom: 1rem;
         border-bottom: 2px solid var(--gray-100);
     }

     .stats-header h3 {
         font-size: 1.3rem;
         font-weight: 700;
         color: var(--gray-900);
         margin: 0;
     }

     .stat-item {
         text-align: center;
         padding: 1.5rem;
         background: var(--gray-50);
         border-radius: 12px;
         transition: all 0.3s ease;
         border: 2px solid transparent;
     }

     .stat-item:hover {
         background: white;
         border-color: var(--primary-200);
         transform: translateY(-2px);
         box-shadow: 0 5px 15px rgba(0,0,0,0.1);
     }

     .featured-stat {
         background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);
         border: 2px solid var(--primary-200);
     }

     .stat-number {
         display: block;
         font-size: 2.5rem;
         font-weight: 900;
         color: var(--primary-500);
         margin-bottom: 0.5rem;
         line-height: 1;
     }

     .stat-label {
         font-size: 1rem;
         color: var(--gray-800);
         font-weight: 600;
         display: block;
         margin-bottom: 0.25rem;
     }

     .stat-detail {
         font-size: 0.85rem;
         color: var(--gray-600);
         font-style: italic;
     }

     .cta-stat {
         background: var(--primary-500);
         color: white;
         padding: 0;
         border-radius: 12px;
         overflow: hidden;
     }

     .cta-stat:hover {
         background: var(--primary-600);
         transform: translateY(-3px);
     }

     .catalog-browse-btn {
         width: 100%;
         padding: 1.5rem 1rem !important;
         border-radius: 12px !important;
         background: transparent !important;
         color: white !important;
         border: none !important;
         font-weight: 700;
         font-size: 1rem;
         display: flex !important;
         align-items: center;
         justify-content: center;
         gap: 0.5rem;
         text-decoration: none;
         transition: all 0.3s ease;
     }

     .catalog-browse-btn:hover {
         background: rgba(255,255,255,0.1) !important;
         transform: none;
     }

     .btn-icon {
         font-size: 1.2rem;
     }

     /* Education Section */
     .education-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
         gap: 2rem;
         max-width: 1200px;
         margin: 0 auto;
     }

     .education-card {
         background: white;
         padding: 2rem;
         border-radius: 12px;
         text-align: center;
         box-shadow: 0 5px 15px rgba(0,0,0,0.08);
         transition: all 0.3s ease;
     }

     .education-card:hover {
         transform: translateY(-5px);
         box-shadow: 0 15px 30px rgba(0,0,0,0.15);
     }

     .card-icon {
         font-size: 3rem;
         margin-bottom: 1rem;
     }

     .education-card h3 {
         font-size: 1.3rem;
         font-weight: 600;
         color: var(--gray-900);
         margin-bottom: 1rem;
     }

     .education-card p {
         color: var(--gray-600);
         line-height: 1.6;
         margin-bottom: 1.5rem;
     }

     /* Enhanced Featured Compositions Styles */
     .featured-compositions-container {
         max-width: 1200px;
         margin: 0 auto;
         padding: 2rem;
     }

     .featured-main-display {
         margin-bottom: 2rem;
     }

     .featured-composition-card {
         background: white;
         border-radius: 20px;
         padding: 2.5rem;
         box-shadow: 0 10px 30px rgba(0,0,0,0.1);
         border: 1px solid var(--gray-200);
         transition: all 0.4s ease;
         position: relative;
         overflow: hidden;
     }

     .featured-composition-card::before {
         content: '';
         position: absolute;
         top: 0;
         left: -100%;
         width: 100%;
         height: 4px;
         background: linear-gradient(90deg, var(--primary-400), var(--primary-600));
         transition: left 0.6s ease;
     }

     .featured-composition-card.active::before {
         left: 0;
     }

     .featured-composition-card:hover {
         transform: translateY(-5px);
         box-shadow: 0 20px 40px rgba(0,0,0,0.15);
     }

     .featured-header {
         display: flex;
         gap: 2rem;
         margin-bottom: 2rem;
         align-items: flex-start;
     }

     .featured-image-container {
         flex: 0 0 200px;
         border-radius: 12px;
         overflow: hidden;
         box-shadow: 0 5px 15px rgba(0,0,0,0.1);
     }

     .featured-image {
         width: 100%;
         height: 150px;
         object-fit: cover;
         transition: transform 0.3s ease;
     }

     .featured-composition-card:hover .featured-image {
         transform: scale(1.05);
     }

     .featured-info {
         flex: 1;
     }

     .featured-title {
         font-size: 1.8rem;
         font-weight: 700;
         color: var(--gray-900);
         margin-bottom: 0.5rem;
         line-height: 1.2;
     }

     .featured-instrumentation {
         font-size: 1.1rem;
         color: var(--primary-600);
         font-weight: 600;
         margin-bottom: 1rem;
     }

     .featured-description {
         color: var(--gray-600);
         line-height: 1.6;
         margin-bottom: 1.5rem;
     }

     .featured-meta {
         display: flex;
         gap: 1rem;
         flex-wrap: wrap;
         margin-bottom: 1.5rem;
     }

     .meta-badge {
         background: var(--gray-100);
         color: var(--gray-700);
         padding: 0.4rem 0.8rem;
         border-radius: 20px;
         font-size: 0.85rem;
         font-weight: 600;
     }

     .meta-badge.featured {
         background: var(--primary-100);
         color: var(--primary-700);
     }

     /* Enhanced Audio Section */
     .featured-audio-section {
         background: var(--gray-50);
         border-radius: 12px;
         padding: 1.5rem;
         margin: 1.5rem 0;
         border: 1px solid var(--gray-200);
     }

     .audio-header {
         display: flex;
         align-items: center;
         gap: 0.75rem;
         margin-bottom: 1rem;
     }

     .audio-icon {
         font-size: 1.2rem;
         color: var(--primary-500);
     }

     .audio-title {
         font-size: 1rem;
         font-weight: 600;
         color: var(--gray-800);
     }

     .audio-controls {
         display: flex;
         align-items: center;
         gap: 1rem;
         margin-bottom: 1rem;
     }

     .audio-nav-btn {
         background: var(--primary-500);
         color: white;
         border: none;
         border-radius: 50%;
         width: 40px;
         height: 40px;
         display: flex;
         align-items: center;
         justify-content: center;
         cursor: pointer;
         transition: all 0.3s ease;
         font-size: 1.2rem;
     }

     .audio-nav-btn:hover {
         background: var(--primary-600);
         transform: scale(1.1);
     }

     .audio-nav-btn:disabled {
         background: var(--gray-300);
         cursor: not-allowed;
         transform: none;
     }

     .audio-info {
         flex: 1;
         text-align: center;
         font-size: 0.9rem;
         color: var(--gray-600);
     }

     .featured-audio-player {
         width: 100%;
         height: 50px;
         border-radius: 8px;
         background: white;
         border: 1px solid var(--gray-300);
     }

     /* Score Section */
     .featured-score-section {
         background: var(--primary-50);
         border-radius: 12px;
         padding: 1.5rem;
         margin: 1.5rem 0;
         border: 1px solid var(--primary-200);
         display: none;
     }

     .featured-score-section.active {
         display: block;
     }

     .score-header {
         display: flex;
         align-items: center;
         gap: 0.75rem;
         margin-bottom: 1rem;
     }

     .score-icon {
         font-size: 1.2rem;
         color: var(--primary-600);
     }

     .score-title {
         font-size: 1rem;
         font-weight: 600;
         color: var(--primary-800);
     }

     .score-viewer {
         background: white;
         border-radius: 8px;
         overflow: hidden;
         margin-bottom: 1rem;
         border: 1px solid var(--primary-300);
     }

     .score-iframe {
         width: 100%;
         height: 500px;
         border: none;
     }

     .score-audio-section {
         background: white;
         border-radius: 8px;
         padding: 1rem;
         border: 1px solid var(--primary-200);
     }

     /* Action Buttons */
     .featured-actions {
         display: flex;
         gap: 1rem;
         flex-wrap: wrap;
     }

     .featured-actions .btn-primary {
         flex: 1;
         min-width: 140px;
         padding: 0.875rem 1.5rem;
         font-weight: 600;
         border-radius: 10px;
         transition: all 0.3s ease;
     }

     .featured-actions .btn-secondary {
         flex: 1;
         min-width: 140px;
         padding: 0.875rem 1.5rem;
         font-weight: 600;
         border-radius: 10px;
         background: var(--gray-100);
         color: var(--gray-700);
         border: 2px solid var(--gray-300);
         transition: all 0.3s ease;
     }

     .featured-actions .btn-secondary:hover {
         background: var(--gray-200);
         border-color: var(--gray-400);
         transform: translateY(-2px);
     }

     .featured-actions .btn-score {
         background: var(--primary-100);
         color: var(--primary-700);
         border: 2px solid var(--primary-300);
     }

     .featured-actions .btn-score:hover {
         background: var(--primary-200);
         border-color: var(--primary-400);
     }

     /* Navigation Controls */
     .featured-controls {
         display: flex;
         align-items: center;
         justify-content: space-between;
         margin-bottom: 1.5rem;
         padding: 0 1rem;
     }

     .featured-nav-btn {
         display: flex;
         align-items: center;
         gap: 0.5rem;
         background: white;
         border: 2px solid var(--gray-200);
         border-radius: 25px;
         padding: 0.75rem 1.25rem;
         cursor: pointer;
         transition: all 0.3s ease;
         font-weight: 600;
         color: var(--gray-700);
     }

     .featured-nav-btn:hover {
         border-color: var(--primary-300);
         background: var(--primary-50);
         color: var(--primary-700);
         transform: translateY(-2px);
     }

     .featured-nav-btn:disabled {
         opacity: 0.5;
         cursor: not-allowed;
         transform: none;
     }

     .nav-icon {
         font-size: 1.4rem;
         font-weight: bold;
     }

     .featured-indicators {
         display: flex;
         gap: 0.5rem;
         align-items: center;
     }

     .indicator-dot {
         width: 12px;
         height: 12px;
         border-radius: 50%;
         background: var(--gray-300);
         cursor: pointer;
         transition: all 0.3s ease;
     }

     .indicator-dot.active {
         background: var(--primary-500);
         transform: scale(1.2);
     }

     .indicator-dot:hover {
         background: var(--primary-400);
         transform: scale(1.1);
     }

     /* Auto-cycle Control */
     .auto-cycle-control {
         text-align: center;
         padding: 1rem;
     }

     .cycle-toggle {
         display: inline-flex;
         align-items: center;
         gap: 0.75rem;
         cursor: pointer;
         font-size: 0.9rem;
         color: var(--gray-600);
     }

     .toggle-slider {
         position: relative;
         width: 50px;
         height: 24px;
         background: var(--gray-300);
         border-radius: 24px;
         transition: all 0.3s ease;
     }

     .toggle-slider::before {
         content: '';
         position: absolute;
         top: 2px;
         left: 2px;
         width: 20px;
         height: 20px;
         background: white;
         border-radius: 50%;
         transition: all 0.3s ease;
         box-shadow: 0 2px 4px rgba(0,0,0,0.2);
     }

     .cycle-toggle input:checked + .toggle-slider {
         background: var(--primary-500);
     }

     .cycle-toggle input:checked + .toggle-slider::before {
         transform: translateX(26px);
     }

     .cycle-toggle input {
         display: none;
     }

     /* Mobile Responsive */
     @media (max-width: 768px) {
         .featured-compositions-container {
             padding: 1rem;
         }

         .featured-composition-card {
             padding: 1.5rem;
         }

         .featured-header {
             flex-direction: column;
             gap: 1rem;
         }

         .featured-image-container {
             flex: none;
             width: 100%;
             max-width: 300px;
             margin: 0 auto;
         }

         .featured-actions {
             flex-direction: column;
         }

         .featured-controls {
             flex-direction: column;
             gap: 1rem;
             text-align: center;
         }

         .featured-nav-btn {
             width: 100%;
             justify-content: center;
         }

                                     .score-iframe {
             height: 400px;
         }
     }

     .composition-featured-instrumentation {
         font-size: 1.3rem;
         color: var(--primary-600);
         font-weight: 500;
         margin-bottom: 1rem;
     }

     .composition-featured-description {
         color: var(--gray-700);
         line-height: 1.6;
         font-size: 1.1rem;
         margin-bottom: 1.5rem;
     }

     .composition-meta-badges {
         display: flex;
         gap: 0.75rem;
         flex-wrap: wrap;
         margin-bottom: 2rem;
     }

     .composition-meta-badge {
         padding: 0.5rem 1rem;
         background: var(--gray-100);
         color: var(--gray-700);
         border-radius: 25px;
         font-size: 0.9rem;
         font-weight: 500;
         border: 1px solid var(--gray-200);
     }

     .composition-meta-badge.featured {
         background: var(--primary-100);
         color: var(--primary-700);
         border-color: var(--primary-200);
     }

     .composition-actions {
         display: flex;
         gap: 1rem;
         flex-wrap: wrap;
     }

     .composition-actions .btn-primary {
         flex: 0 0 auto;
         min-width: 150px;
         padding: 0.75rem 1.5rem;
         font-size: 1rem;
     }

     .composition-actions .btn-secondary {
         flex: 0 0 auto;
         min-width: 150px;
         padding: 0.75rem 1.5rem;
         font-size: 1rem;
         background: transparent;
         color: var(--gray-700);
         border: 2px solid var(--gray-300);
     }

     .composition-actions .btn-secondary:hover {
         background: var(--gray-100);
         border-color: var(--gray-400);
     }

     /* Navigation Controls */
     .carousel-navigation {
         display: flex;
         justify-content: center;
         align-items: center;
         gap: 2rem;
         margin: 2rem 0;
     }

     .carousel-nav-btn {
         background: var(--primary-500);
         color: white;
         border: none;
         padding: 0.75rem 1.5rem;
         border-radius: 25px;
         cursor: pointer;
         font-weight: 600;
         transition: all 0.3s ease;
         display: flex;
         align-items: center;
         gap: 0.5rem;
     }

     .carousel-nav-btn:hover:not(:disabled) {
         background: var(--primary-600);
         transform: translateY(-2px);
         box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
     }

     .carousel-nav-btn:disabled {
         background: var(--gray-400);
         cursor: not-allowed;
         transform: none;
         box-shadow: none;
     }

     .carousel-indicators {
         display: flex;
         gap: 0.5rem;
     }

     .carousel-indicator-dot {
         width: 12px;
         height: 12px;
         border-radius: 50%;
         background: var(--gray-300);
         cursor: pointer;
         transition: all 0.3s ease;
     }

     .carousel-indicator-dot.active {
         background: var(--primary-500);
         transform: scale(1.2);
     }

     .carousel-indicator-dot:hover {
         background: var(--primary-400);
         transform: scale(1.1);
     }

     @media (max-width: 768px) {
         .composition-card-layout {
             grid-template-columns: 1fr;
             gap: 2rem;
             text-align: center;
         }

         .composition-featured-title {
             font-size: 2rem;
         }

         .composition-featured-instrumentation {
             font-size: 1.1rem;
         }

         .composition-actions {
             justify-content: center;
         }

         .carousel-navigation {
             flex-direction: column;
             gap: 1rem;
         }

         .carousel-nav-btn {
             width: 100%;
             max-width: 200px;
             justify-content: center;
         }
     }

     .card-link {
         color: var(--primary-500);
         font-weight: 600;
         text-decoration: none;
         transition: color 0.3s ease;
     }

     .card-link:hover {
         color: var(--primary-600);
     }

     /* Footer Styles - MOVED TO styles.css for modular template system */
     /* See styles.css for footer CSS - removed duplicate */

     /* Testimonials Section */
     .testimonials-section {
         padding: 4rem 0;
         background: var(--gray-900);
         color: white;
     }

     .testimonials-section .section-title {
         color: white;
     }

     .testimonials-grid {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
         gap: 2rem;
         max-width: 1200px;
         margin: 0 auto;
     }

     .testimonial-card {
         background: rgba(255,255,255,0.1);
         padding: 2rem;
         border-radius: 12px;
         backdrop-filter: blur(10px);
         border: 1px solid rgba(255,255,255,0.1);
     }

     .testimonial-content p {
         font-style: italic;
         font-size: 1.1rem;
         line-height: 1.6;
         margin-bottom: 1.5rem;
         color: var(--gray-200);
     }

     .testimonial-author strong {
         color: white;
         display: block;
         margin-bottom: 0.25rem;
     }

     .testimonial-author span {
         color: var(--gray-400);
         font-size: 0.9rem;
     }

     /* Mobile Responsiveness */
     @media (max-width: 768px) {
         .catalog-highlights-grid {
             grid-template-columns: 1fr;
             gap: 2rem;
         }

         .featured-composition {
             flex-direction: column;
             min-height: auto;
         }

         .featured-composition-image {
             height: 250px;
             min-height: 250px;
         }

         .featured-composition-content {
             padding: 2rem 1.5rem;
         }

         .featured-title {
             font-size: 1.5rem;
         }

         .composition-actions {
             flex-direction: column;
         }

         .composition-actions .btn-primary,
         .composition-actions .btn-secondary {
             flex: none;
             width: 100%;
         }

         .catalog-stats {
             padding: 1.5rem;
             gap: 1rem;
         }

         .stats-header {
             margin-bottom: 0.5rem;
             padding-bottom: 0.5rem;
         }

         .stat-item {
             padding: 1rem;
         }

         .stat-number {
             font-size: 2rem;
         }

         .catalog-browse-btn {
             padding: 1.25rem 1rem !important;
         }

         .section-title {
             font-size: 2rem;
         }

         .section-subtitle {
             font-size: 1rem;
         }

         .education-card, .testimonial-card {
             padding: 1.5rem;
         }
     }

      /* Call to Action Section */
      .cta-section {
          padding: 4rem 0;
          background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
          color: white;
          text-align: center;
      }

      .cta-content h2 {
          font-size: 2.5rem;
          font-weight: 700;
          margin-bottom: 1rem;
          color: white;
      }

      .cta-content p {
          font-size: 1.2rem;
          margin-bottom: 2rem;
          color: rgba(255,255,255,0.9);
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
      }

      .cta-buttons {
          display: flex;
          gap: 1rem;
          justify-content: center;
          flex-wrap: wrap;
      }

      .cta-buttons .btn-primary {
          background: white;
          color: var(--primary-600);
          border: 2px solid white;
      }

      .cta-buttons .btn-primary:hover {
          background: transparent;
          color: white;
          border-color: white;
      }

      .cta-buttons .btn-secondary {
          background: transparent;
          color: white;
          border: 2px solid rgba(255,255,255,0.5);
      }

      .cta-buttons .btn-secondary:hover {
          background: rgba(255,255,255,0.1);
          border-color: white;
      }

      @media (max-width: 768px) {
          .cta-content h2 {
              font-size: 2rem;
          }
          
          .cta-content p {
              font-size: 1rem;
          }
          
          .cta-buttons {
              flex-direction: column;
              align-items: center;
          }
          
          .cta-buttons a {
              width: 200px;
          }
      }
      
      /* Hero Container Styles */
      .hero-container {
          position: relative;
          width: 100vw;
          height: 100vh;
          min-height: 100vh;
          overflow: hidden;
          display: flex;
          align-items: center;
          justify-content: center;
          margin-left: calc(50% - 50vw);
          margin-right: calc(50% - 50vw);
          margin-top: 95px; /* Account for primary nav (70px) + secondary nav (40px) */
          box-sizing: border-box;
      }
      
      .hero-carousel {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1;
          overflow: hidden;
      }
      
      /* Enhanced Hero Video Styles - YouTube Embed */
      .hero-video-container {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 2;
          opacity: 0;
          transition: all 1.2s ease;
      }

      .hero-video-container.loaded {
          opacity: 1;
      }

      .hero-video-youtube {
          position: absolute;
          top: 50%;
          left: 50%;
          width: 100vw;
          height: 100vh;
          min-height: 100vh;
          min-width: 100vw;
          transform: translate(-50%, -50%) scale(1.05);
          filter: brightness(0.9) contrast(1.2) saturate(1.1);
          pointer-events: none; /* Prevent user interaction */
          z-index: 1; /* Ensure it's behind content */
      }

      .hero-video {
          /* Fallback styles for video element if needed */
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          object-fit: cover;
          z-index: 2;
          opacity: 0;
          transition: all 1.2s ease;
          filter: brightness(0.8) contrast(1.1);
      }

      .hero-video.loaded {
          opacity: 1;
          filter: brightness(0.9) contrast(1.2) saturate(1.1);
          transform: scale(1.02);
      }

      .hero-fallback-image {
          position: absolute;
          top: 0;
          left: 0;
          width: 100vw;
          height: 100vh;
          object-fit: cover;
          z-index: 2;
          opacity: 1;
          transition: opacity 1s ease, transform 0.5s ease;
          filter: brightness(0.8);
      }

      .hero-fallback-image.hidden {
          opacity: 0;
          z-index: 1 !important;
          transform: scale(0.98);
          visibility: hidden;
          pointer-events: none;
      }

      .hero-fallback-image.active {
          opacity: 1;
          z-index: 2 !important;
          transform: scale(1);
          visibility: visible;
          pointer-events: auto;
      }
      
      /* Hero Content Overlay */
      .hero-content-overlay {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(
              45deg,
              rgba(0, 0, 0, 0.4) 0%,
              rgba(0, 0, 0, 0.2) 50%,
              rgba(0, 0, 0, 0.3) 100%
          );
          z-index: 3;
          pointer-events: none;
      }
      
      .hero-content-wrapper {
          position: absolute;
          bottom: 20%;
          left: 0;
          right: 0;
          z-index: 15;
          text-align: center;
          pointer-events: auto;
          /* Ensure all child elements can receive pointer events */
          pointer-events: auto;
      }

      /* Ensure all interactive elements within hero content are clickable */
      .hero-content-wrapper * {
          pointer-events: auto;
      }

      /* Specific styling for the hero roles to ensure they're clickable */
      .hero-role {
          pointer-events: auto;
          position: absolute !important;
          z-index: 16;
      }

      /* Ensure the navigation dots container is clickable */
      .hero-nav-dots {
          pointer-events: auto;
          position: relative;
          z-index: 16;
      }
      
      @media (max-width: 768px) {
          .hero-container {
              height: 100vh;
              min-height: 100vh;
              margin-top: 100px; /* Reduced for mobile - nav elements are smaller */
          }
          
          .hero-content-wrapper {
              bottom: 15%;
          }
          
          /* secondary-nav mobile styles moved to styles.css */
      }
      
      /* Main Content Container */
      .main-content-container {
          width: 100%;
          max-width: 100%;
          overflow-x: hidden;
          box-sizing: border-box;
      }
      
      /* Ensure all sections respect container width */
      .container {
          max-width: 96%;
          margin: 0 auto;
          padding: 0 1rem;
          width: 96%;
      }
      
      .section-showcase {
          width: 100%;
          max-width: 100%;
          overflow-x: hidden;
          padding: 4rem 0;
          box-sizing: border-box;
      }
      
      /* Navigation Styles - MOVED TO styles.css for modular template system */
      /* See styles.css for navigation CSS - removed duplicate */
      
      /* Ensure hero content doesn't overflow */
      .hero-content-dynamic {
          width: 100%;
          max-width: 800px;
          margin: 0 auto;
          padding: 0 1rem;
          position: relative;
          z-index: 15;
      }
      
      .hero-main-title {
          font-size: clamp(2.5rem, 8vw, 4rem);
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
      }
      
      .hero-role-title {
          font-size: clamp(1.5rem, 5vw, 2.5rem);
      }
      
      .hero-role-description {
          font-size: clamp(1rem, 3vw, 1.2rem);
          max-width: 600px;
          margin: 0 auto 1.5rem;
      }
      
      @media (max-width: 1200px) {
          .container {
              max-width: 96%;
          }
      }
      
      @media (max-width: 768px) {
          .hero-main-title {
              font-size: 2.5rem;
              white-space: normal;
          }
          
          .hero-role-title {
              font-size: 1.8rem;
          }
          
          .hero-role-description {
              font-size: 1rem;
          }
          
          .hero-content-dynamic {
              padding: 0 1.5rem;
          }
    }



    /* Welcome & Navigation Section */
    .welcome-section {
        padding: 1rem 0;
        background: white;
        text-align: center;
    }

    .welcome-content {
        max-width: 800px;
        margin: 0 auto;
    }

    .welcome-title {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: 0.25rem;
    }

    .welcome-subtitle {
        font-size: 1.2rem;
        color: var(--gray-600);
        margin-bottom: 1rem;
    }

    .main-navigation {
        display: flex;
        justify-content: center;
        gap: 1.5rem;
        flex-wrap: wrap;
    }

    .nav-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 1rem 1.5rem;
        background: var(--primary-500);
        border: 1px solid var(--primary-500);
        border-radius: 8px;
        text-decoration: none;
        color: white;
        transition: all 0.3s ease;
        min-width: 120px;
        font-weight: 600;
    }

    .nav-card:hover {
        background: var(--primary-600);
        border-color: var(--primary-600);
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
        color: white;
    }

    .nav-card .nav-icon {
        font-size: 2rem;
        margin-bottom: 0.5rem;
    }

    .nav-card span {
        font-weight: 600;
        font-size: 0.9rem;
    }

    /* Highlights Section */
    .highlights-section {
        padding: 1rem 0;
        background: var(--gray-50);
        position: relative;
        z-index: 1;
    }

    .highlights-grid {
        display: flex;
        gap: 2rem;
        align-items: stretch;
    }
    
    /* Make catalog highlight (new releases) take more width than media highlight */
    .highlight-card.catalog-highlight {
        flex: 1.38; /* 58% of total width (1.38 / (1.38 + 1) = 0.58) */
    }
    
    .highlight-card.media-highlight {
        flex: 1; /* 42% of total width (1 / (1.38 + 1) = 0.42) */
    }

    .highlight-card {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: 1px solid var(--gray-200);
        transition: all 0.3s ease;
    }
    


    .highlight-card:hover {
        /* Removed transform animation - keeping only subtle shadow */
        box-shadow: 0 8px 30px rgba(0,0,0,0.12);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

    .card-header h3 {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
    }

    .card-badge {
        padding: 0.25rem 0.75rem;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .news-highlight .card-badge {
        background: var(--primary-100);
        color: var(--primary-700);
    }

    .catalog-highlight .card-badge {
        background: var(--gray-100);
        color: var(--gray-700);
    }

    .media-highlight .card-badge {
        background: var(--gray-100);
        color: var(--gray-700);
    }

    .card-content {
        margin-bottom: 1.5rem;
    }

    .card-footer {
        border-top: 1px solid var(--gray-200);
        padding-top: 1rem;
    }

    .card-link {
        color: var(--primary-600);
        font-weight: 600;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .card-link:hover {
        color: var(--primary-700);
    }

    /* News Placeholder */
    .news-placeholder {
        text-align: center;
        padding: 2rem 1rem;
        color: var(--gray-500);
    }

    .placeholder-icon {
        font-size: 3rem;
        margin-bottom: 1rem;
    }

    .placeholder-note {
        font-size: 0.85rem;
        color: var(--gray-400);
        font-style: italic;
    }

    /* Catalog Preview */
    .composition-featured {
        display: flex;
        flex-direction: row;
        gap: 2rem;
        align-items: flex-start;
        transition: all 0.4s ease-out;
    }

    /* Enhanced New Release Animation System - Optimized Timing */
    .composition-featured.fade-out {
        opacity: 0;
        transform: translateY(20px) scale(0.95);
        transition: all 0.3s ease-out;
    }

    .composition-featured.fade-in {
        opacity: 1;
        transform: translateY(0) scale(1);
        transition: all 0.4s ease-out;
    }

    /* Separate animations for cover and details - Optimized Timing */
    .composition-featured.fade-out .composition-img {
        transform: translateX(-25px) scale(0.9);
        opacity: 0.6;
        transition: all 0.3s ease-out;
    }

    .composition-featured.fade-out .composition-details {
        transform: translateX(25px);
        opacity: 0.4;
        transition: all 0.3s ease-out 0.1s;
    }

    .composition-featured.fade-in .composition-img {
        transform: translateX(0) scale(1);
        opacity: 1;
        transition: all 0.4s ease-out 0.15s;
    }

    .composition-featured.fade-in .composition-details {
        transform: translateX(0);
        opacity: 1;
        transition: all 0.4s ease-out 0.25s;
    }

    .composition-image {
        flex: 0 0 220px; /* Slightly larger width for the image container */
        height: 280px; /* Set a fixed height for the container */
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        position: relative; /* Required for absolute positioning of ::before */
    }

    .composition-img {
        width: 100%;
        height: 100%; /* Fill the entire container height */
        object-fit: cover;
        display: block; /* Removes any extra space below the image */
    }
    
    /* Default cover image when no image is available */
    .composition-image::before {
        content: '🎼';
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 4rem;
        color: var(--gray-400);
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        background: var(--gray-100);
        border-radius: 12px;
    }
    
    .composition-image.has-image::before {
        display: none;
    }

    .composition-details {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .title-badge-container {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 1rem;
    }

    .title-instrumentation-container {
        flex: 1;
    }

    .composition-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
        line-height: 1.2;
    }

    .composition-instrumentation {
        font-size: 1.1rem;
        color: var(--primary-600);
        font-weight: 600;
        margin: 0;
    }

    .composition-description {
        font-size: 1rem;
        color: var(--gray-600);
        line-height: 1.6;
        margin: 0;
    }

    .composition-metadata {
        display: flex;
        gap: 0.5rem;
        flex-wrap: wrap;
        margin-top: 0.5rem;
    }

    .metadata-tag {
        padding: 0.25rem 0.75rem;
        background: var(--gray-100);
        color: var(--gray-600);
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 500;
    }

    .metadata-tag.featured {
        background: var(--primary-100);
        color: var(--primary-700);
    }

    .composition-actions {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
        margin-top: 0.5rem;
    }

    .btn-icon {
        margin-right: 0.5rem;
        font-size: 0.9rem;
    }

    .btn-primary {
        background: white;
        color: var(--primary-600);
        border: 1px solid var(--gray-300);
        padding: 0.5rem 1rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
    }

    .btn-primary:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
        transform: translateY(-1px);
    }

    .btn-secondary {
        background: white;
        color: var(--primary-600);
        border: 1px solid var(--gray-300);
        padding: 0.5rem 1rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
    }

    .btn-secondary:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
        transform: translateY(-1px);
    }

    .btn-buy {
        background: var(--primary-500);
        color: white;
        border: 1px solid var(--primary-500);
        padding: 0.5rem 1rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
    }

    .btn-buy:hover {
        background: var(--primary-600);
        border-color: var(--primary-600);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .btn-listen {
        background: var(--gray-600);
        color: white;
        border: 1px solid var(--gray-600);
        padding: 0.5rem 1rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-listen.in-view {
        background: #ff6b35;
        color: white;
        border: 1px solid #ff6b35;
    }

    .btn-listen .status-circle {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 2px solid white;
        background: transparent;
        transition: all 0.3s ease;
    }

    .btn-listen.in-view .status-circle {
        background: white;
    }

    .btn-listen:hover {
        background: var(--primary-200);
        border-color: var(--primary-300);
        transform: translateY(-1px);
    }

    .btn-score {
        background: var(--gray-600);
        color: white;
        border: 1px solid var(--gray-600);
        padding: 0.5rem 1rem;
        border-radius: 6px;
        text-decoration: none;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 0.85rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-score.in-view {
        background: #ff6b35;
        color: white;
        border: 1px solid #ff6b35;
    }

    .btn-score .status-circle {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: 2px solid white;
        background: transparent;
        transition: all 0.3s ease;
    }

    .btn-score.in-view .status-circle {
        background: white;
    }

    .btn-score:hover {
        background: var(--primary-200);
        border-color: var(--primary-300);
        transform: translateY(-1px);
    }

    /* Featured Audio Player Section */
    .featured-audio-section {
        padding: 2rem 0;
        background: var(--gray-50);
        border-top: 1px solid var(--gray-200);
        border-bottom: 1px solid var(--gray-200);
    }

    .audio-player-container {
        background: white;
        border-radius: 16px;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: 1px solid var(--gray-200);
    }

    .audio-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--gray-200);
    }

    .audio-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: var(--gray-900);
        margin: 0;
    }

    .close-audio-btn {
        background: var(--gray-200);
        color: var(--gray-600);
        border: none;
        border-radius: 50%;
        width: 32px;
        height: 32px;
        cursor: pointer;
        font-size: 1.2rem;
        font-weight: bold;
        transition: all 0.3s ease;
    }

    .close-audio-btn:hover {
        background: var(--gray-300);
        color: var(--gray-700);
    }

    .audio-content {
        display: flex;
        gap: 2rem;
        align-items: center;
    }

    .audio-info {
        display: flex;
        gap: 1rem;
        align-items: center;
        flex: 0 0 auto;
    }

    .audio-cover {
        width: 80px;
        height: 80px;
        border-radius: 8px;
        object-fit: cover;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .audio-details h4 {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--gray-900);
        margin: 0 0 0.25rem 0;
    }

    .audio-details p {
        font-size: 0.9rem;
        color: var(--gray-600);
        margin: 0;
    }

    .audio-controls {
        flex: 1;
    }

    .audio-controls audio {
        width: 100%;
        height: 40px;
    }

    /* New Catalog Release Divider */
    .new-release-divider {
        height: 3px;
        background: linear-gradient(90deg, transparent 0%, var(--primary-400) 20%, var(--primary-500) 50%, var(--primary-400) 80%, transparent 100%);
        margin: 1rem 0 0.75rem 0;
        border-radius: 2px;
        opacity: 0.8;
    }

    /* New Catalog Release Carousel Navigation */
    .new-release-carousel-nav {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 0.75rem;
        padding: 0 1rem;
    }

    .nav-btn {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        color: #495057;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .nav-btn:hover {
        background: #e9ecef;
        border-color: #dee2e6;
    }

    .nav-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }

    .nav-btn.next-btn {
        background: var(--primary-500);
        color: white;
        border-color: var(--primary-500);
    }

    .nav-btn.next-btn:hover {
        background: var(--primary-600);
        border-color: var(--primary-600);
        transform: translateY(-1px);
        box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
    }

    .carousel-dots {
        display: flex;
        gap: 0.5rem;
        align-items: center;
    }

    .carousel-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #dee2e6;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .carousel-dot.active {
        background: #007bff;
        transform: scale(1.2);
    }

    .auto-cycle-toggle {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.75rem;
        margin-top: 1rem;
    }

    .toggle-switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 24px;
    }

    .toggle-switch input {
        opacity: 0;
        width: 0;
        height: 0;
    }

    .toggle-slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        transition: 0.4s;
        border-radius: 24px;
    }

    .toggle-slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 3px;
        bottom: 3px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
    }

    input:checked + .toggle-slider {
        background-color: #007bff;
    }

    input:checked + .toggle-slider:before {
        transform: translateX(26px);
    }

    .toggle-label {
        font-size: 0.85rem;
        color: #6c757d;
    }

        /* New Release Loading State */
    .new-release-loading {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 200px;
        padding: 2rem;
        background: linear-gradient(135deg, var(--gray-50) 0%, var(--gray-100) 100%);
        border-radius: 12px;
        border: 2px dashed var(--gray-300);
        animation: loadingPulse 2s ease-in-out infinite;
    }

    .loading-content {
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
    }

    .loading-image {
        width: 80px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .loading-spinner {
        width: 60px;
        height: 60px;
        border: 4px solid var(--gray-200);
        border-top: 4px solid var(--primary-500);
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .loading-text h3 {
        color: var(--gray-700);
        font-size: 1.2rem;
        font-weight: 600;
        margin: 0;
    }

    .loading-text p {
        color: var(--gray-500);
        font-size: 0.9rem;
        margin: 0;
    }

    @keyframes loadingPulse {
        0%, 100% {
            opacity: 0.8;
            transform: scale(1);
        }
        50% {
            opacity: 1;
            transform: scale(1.02);
        }
    }

    /* New Release Integrated Audio Player */
    .new-release-audio-container {
        margin-top: 1.5rem;
        padding: 1.5rem;
        background: var(--gray-50);
        border-radius: 12px;
        border: 1px solid var(--gray-200);
        opacity: 0;
        transform: translateY(-10px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        pointer-events: none;
        max-height: 0;
        overflow: hidden;
        margin-bottom: 0;
    }

    .new-release-audio-container.has-audio {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
        max-height: 500px;
        animation: slideDown 0.3s ease-out;
        margin-bottom: 1.5rem;
        display: block;
    }

    .new-release-audio-container.no-audio {
        opacity: 0;
        transform: translateY(-10px);
        pointer-events: none;
        max-height: 0;
        overflow: hidden;
                    margin: 0;
                    padding: 0;
                    display: none;
    }

    .audio-player-content {
        display: flex;
        flex-direction: column;
        gap: 1rem;
        align-items: stretch;
    }

    .audio-info {
        display: flex;
        gap: 1rem;
        align-items: center;
        flex: 0 0 auto;
    }

    .audio-cover {
        width: 60px;
        height: 60px;
        border-radius: 8px;
        object-fit: cover;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .audio-details h4 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-900);
        margin: 0 0 0.25rem 0;
    }

    .audio-details p {
        font-size: 0.85rem;
        color: var(--gray-600);
        margin: 0;
    }

    .audio-controls {
        flex: 1;
    }

    .audio-controls audio {
        width: 100%;
        height: 36px;
    }

    .performed-by-info {
        text-align: center;
        padding: 0.5rem 0;
    }

    .performed-by-text {
        font-size: 0.9rem;
        color: var(--gray-600);
        margin: 0;
        font-weight: 500;
    }

    .performed-by-artist {
        color: var(--primary-600);
        font-weight: 600;
    }

    /* New Release Multi-Audio Navigation Styles */
    .new-release-audio-nav {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
        margin-top: 1rem;
    }

    .new-release-audio-nav .audio-nav-btn {
        background: var(--primary-500);
        color: white;
        border: none;
        border-radius: 6px;
        padding: 0.5rem 1rem;
        cursor: pointer;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .new-release-audio-nav .audio-nav-btn:hover:not(:disabled) {
        background: var(--primary-600);
        transform: translateY(-1px);
    }

    .new-release-audio-nav .audio-nav-btn:disabled {
        background: var(--gray-400);
        cursor: not-allowed;
        transform: none;
    }

    .new-release-audio-nav .audio-nav-info {
        font-size: 0.9rem;
        color: var(--gray-600);
        font-weight: 500;
    }

    .new-release-audio-player {
        margin-bottom: 1rem;
    }

    .new-release-audio-player .movement-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--primary-600);
        margin-bottom: 0.5rem;
    }

    .new-release-audio-player .audio-metadata {
        font-size: 0.9rem;
        color: var(--gray-600);
        margin-bottom: 0.75rem;
    }

    .new-release-audio-player audio {
        width: 100%;
        margin-bottom: 0.75rem;
    }

    .new-release-audio-player .audio-duration {
        font-size: 0.8rem;
        color: var(--gray-500);
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* ===== RELATED WORKS CAROUSEL COMPONENT STYLES ===== */
    .related-works-carousel-component {
        width: 96%;
        margin: 2rem auto 0;
        padding: 0 1rem;
    }
    
    /* ✨ OPTIMIZED: Popular compositions carousel performance */
    .related-composition-card {
        animation: fadeInUp 0.4s ease-out;
        animation-fill-mode: both;
    }
    
    .related-composition-card:nth-child(1) { animation-delay: 0.1s; }
    .related-composition-card:nth-child(2) { animation-delay: 0.2s; }
    .related-composition-card:nth-child(3) { animation-delay: 0.3s; }
    .related-composition-card:nth-child(4) { animation-delay: 0.4s; }
    .related-composition-card:nth-child(5) { animation-delay: 0.5s; }
    .related-composition-card:nth-child(6) { animation-delay: 0.6s; }

    .related-works-carousel-container {
        background: white;
        border-radius: 12px;
        border: 1px solid var(--gray-200);
        padding: 1.5rem;
        box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
        transition: box-shadow 0.3s ease;
    }

    /* Full width for featured compositions carousel */
    #featured-compositions-carousel .related-works-carousel-container {
        max-width: 100%;
        width: 100%;
    }

    .related-works-carousel-title {
        color: var(--primary-600);
        margin-bottom: 1.5rem;
        font-size: 1.25rem;
        font-weight: 600;
        text-align: center;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid var(--primary-100);
    }

    /* ===== CAROUSEL CONTAINER ===== */
    .related-works-carousel {
        display: flex;
        flex-direction: row;
        overflow-x: auto;
        overflow-y: hidden;
        gap: 1rem;
        padding: 0.5rem 0;
        width: 100%;
        scroll-behavior: smooth;
        -webkit-overflow-scrolling: touch;
        scrollbar-width: thin;
        scrollbar-color: var(--primary-500) var(--gray-200);
    }

    /* Style the scrollbar (Webkit browsers) */
    .related-works-carousel::-webkit-scrollbar {
        height: 6px;
    }

    .related-works-carousel::-webkit-scrollbar-track {
        background: var(--gray-200);
        border-radius: var(--radius-full);
        margin: 0 0.5rem;
    }

    .related-works-carousel::-webkit-scrollbar-thumb {
        background: var(--primary-500);
        border-radius: var(--radius-full);
        border: 1px solid var(--gray-200);
    }

    .related-works-carousel::-webkit-scrollbar-thumb:hover {
        background: var(--primary-600);
    }

    /* ===== COMPOSITION CARDS ===== */
    .related-composition-card {
        min-width: 200px;
        max-width: 200px;
        flex: 0 0 auto;
        background: linear-gradient(145deg, var(--gray-50) 0%, var(--gray-100) 100%);
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        cursor: pointer;
        border: 1px solid var(--gray-200);
        position: relative;
        transform: translateY(20px);
        opacity: 0;
        will-change: transform, box-shadow, background, opacity;
        animation: cardEntrance 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
    }

    /* Staggered entrance animation for cards */
    .related-composition-card:nth-child(1) { animation-delay: 0.1s; }
    .related-composition-card:nth-child(2) { animation-delay: 0.2s; }
    .related-composition-card:nth-child(3) { animation-delay: 0.3s; }
    .related-composition-card:nth-child(4) { animation-delay: 0.4s; }
    .related-composition-card:nth-child(5) { animation-delay: 0.5s; }
    .related-composition-card:nth-child(6) { animation-delay: 0.6s; }

    @keyframes cardEntrance {
        from {
            opacity: 0;
            transform: translateY(20px) scale(0.95);
        }
        to {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
    }

    .related-composition-card:hover {
        transform: translateY(-7px) !important;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25), 0 12px 32px rgba(59, 130, 246, 0.2);
        background: linear-gradient(145deg, var(--gray-50) 0%, var(--primary-50) 100%);
        border-color: var(--primary-300);
        z-index: 10;
    }

    .related-composition-card:hover .related-composition-title {
        color: var(--primary-700);
    }

    /* ===== CARD IMAGE (8.5x11 aspect ratio) ===== */
    .related-composition-image {
        width: 100%;
        height: 258px; /* 200px width * (11/8.5) = 258px height for 8.5x11 ratio */
        object-fit: cover;
        object-position: center;
        transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        background: var(--gray-200);
        will-change: transform;
    }

    .related-composition-card:hover .related-composition-image {
        transform: scale(1);
    }

    /* ===== CARD CONTENT ===== */
    .related-composition-content {
        padding: 0.75rem;
        text-align: center;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .related-composition-title {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--gray-900);
        margin: 0 0 0.25rem 0;
        line-height: 1.2;
        transition: color 0.3s ease;
    }

    .related-composition-instrumentation {
        font-size: 0.75rem;
        color: var(--gray-600);
        font-weight: 500;
        margin-bottom: 0;
        line-height: 1.2;
    }

    /* ===== NEW RELEASE SCORE SECTION ===== */
    .new-release-score-section {
        width: 100%;
        max-width: 1400px;
        margin: 2rem auto 0;
        padding: 2rem 1rem;
        box-sizing: border-box;
        background: var(--gray-50);
        border-radius: 12px;
        border: 1px solid var(--gray-200);
    }

    /* ===== SCORE TOGGLE BUTTONS ===== */
    .score-toggle-container {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 1rem;
        padding: 0 1rem;
        flex-wrap: wrap;
    }

    .score-toggle-btn {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: linear-gradient(135deg, #6b7280, #4b5563); /* Lower saturation primary for hidden */
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 2px 8px rgba(107, 114, 128, 0.2);
    }

    .score-toggle-btn:hover {
        background: linear-gradient(135deg, #4b5563, #374151);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(107, 114, 128, 0.3);
    }

    /* Higher saturation orange for "in view" state */
    .score-toggle-btn.in-view {
        background: linear-gradient(135deg, #f97316, #ea580c);
        box-shadow: 0 2px 8px rgba(249, 115, 22, 0.2);
    }

    .score-toggle-btn.in-view:hover {
        background: linear-gradient(135deg, #ea580c, #dc2626);
        box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);
    }

    .score-toggle-btn:active {
        transform: translateY(0);
    }

    .score-toggle-btn .toggle-icon {
        transition: all 0.3s ease;
        font-size: 1.1rem;
        line-height: 1;
        font-weight: bold;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .score-toggle-btn.toggled .toggle-icon {
        transform: scale(1.1);
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }

    /* Smooth color transitions for state changes */
    .score-toggle-btn {
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    /* ===== RESIZABLE SCORE LAYOUT SYSTEM ===== */
    .score-layout-container {
        display: flex;
        align-items: stretch;
        width: 100%;
        position: relative;
        min-height: 0; /* Remove fixed minimum height */
    }

    /* Add minimum height only when content is visible */
    .score-layout-container:has(.score-carousel-container.show),
    .score-layout-container:has(.score-video-column:not(.hidden)) {
        min-height: 400px;
    }

    /* Fallback for browsers that don't support :has() */
    .score-layout-container.has-content {
        min-height: 400px;
    }

    .score-pdf-column {
        flex: 1 1 60%; /* Default: Larger space for PDF */
        display: flex;
        flex-direction: column;
        min-width: 300px; /* Increased minimum for better proportions */
        max-width: none; /* Remove max-width constraint */
        transition: flex-basis 0.2s ease; /* Smoother transition */
    }

    .score-carousel-container {
        opacity: 0;
        transform: translateX(-20px);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        pointer-events: none;
        height: 0;
        overflow: hidden;
    }

    .score-carousel-container.show {
        opacity: 1;
        transform: translateX(0);
        pointer-events: auto;
        height: auto;
        overflow: visible;
    }

    /* ===== RESIZABLE DIVIDER ===== */
    .score-divider {
        width: 8px;
        background: var(--gray-200);
        position: relative;
        cursor: col-resize;
        transition: all 0.3s ease;
        display: none; /* Hidden by default */
        align-items: center;
        justify-content: center;
        margin: 0 0.5rem;
        opacity: 1;
        transform: scaleX(1);
        z-index: 10; /* Ensure divider is above content */
        user-select: none; /* Prevent text selection during resize */
    }

    /* Hide divider when either column is hidden */
    .score-layout-container.pdf-only .score-divider,
    .score-layout-container.video-only .score-divider {
        display: none !important;
        opacity: 0;
        transform: scaleX(0);
        width: 0;
        margin: 0;
    }

    /* Proper divider handle hiding */
    .score-divider.divider-handle-hidden {
        display: none !important;
        opacity: 0;
        transform: scaleX(0);
        width: 0;
        margin: 0;
        pointer-events: none;
    }

    .score-divider:hover {
        background: var(--primary-300);
    }

    .score-divider.resizing {
        background: var(--primary-500);
        box-shadow: 0 0 8px rgba(59, 130, 246, 0.3);
    }

    /* Add visual feedback during resize */
    .score-layout-container.resizing .score-pdf-column,
    .score-layout-container.resizing .score-video-column {
        transition: none; /* Disable transitions during resize for immediate feedback */
    }
    
    /* Prevent content interference during resize */
    .score-layout-container.resizing {
        pointer-events: none; /* Disable pointer events on content during resize */
    }
    
    .score-layout-container.resizing .score-divider {
        pointer-events: auto; /* Re-enable pointer events on divider */
    }
    
    /* Specifically disable iframe interaction during resize */
    .score-layout-container.resizing iframe {
        pointer-events: none !important;
        user-select: none !important;
    }
    
    /* Disable YouTube iframe interaction during resize */
    .score-layout-container.resizing .youtube-embed-container iframe {
        pointer-events: none !important;
        user-select: none !important;
    }

    .divider-handle {
        width: 100%;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    .divider-grip {
        width: 4px;
        height: 40px;
        background: var(--gray-400);
        border-radius: 2px;
        position: relative;
    }

    .divider-grip::before,
    .divider-grip::after {
        content: '';
        position: absolute;
        left: 50%;
        width: 2px;
        height: 8px;
        background: var(--gray-400);
        border-radius: 1px;
    }

    .divider-grip::before {
        top: 8px;
        transform: translateX(-50%);
    }

    .divider-grip::after {
        bottom: 8px;
        transform: translateX(-50%);
    }

    .score-divider:hover .divider-grip,
    .score-divider.resizing .divider-grip {
        background: var(--primary-600);
    }

    .score-divider:hover .divider-grip::before,
    .score-divider:hover .divider-grip::after,
    .score-divider.resizing .divider-grip::before,
    .score-divider.resizing .divider-grip::after {
        background: var(--primary-600);
    }

    .score-video-column {
        flex: 1 1 40%; /* Default: Smaller space for video */
        display: flex;
        flex-direction: column;
        padding-left: 1rem;
        padding-right: 1rem;
        min-width: 300px; /* Increased minimum width for video column */
        transition: flex-basis 0.2s ease; /* Smoother transition */
        /* ✨ ADDED: Initial state for smooth animation */
        opacity: 0;
        transform: translateX(20px);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94), flex-basis 0.2s ease;
    }

    .score-video-column.full-width {
        flex: 1 1 100%;
        max-width: 1000px;
        margin: 0 auto; /* Center the video when in full width */
        padding-left: 0;
        padding-right: 0;
    }

    .score-video-column.hidden {
        opacity: 0;
        transform: translateX(20px);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        pointer-events: none;
        height: 0;
        overflow: hidden;
    }

    .score-pdf-column.full-width {
        flex: 1 1 100%;
        max-width: 1000px;
        margin: 0 auto; /* Center the PDF when in full width */
        padding-left: 0;
        padding-right: 0;
    }

    /* Better centering for PDF-only layout */
    .score-layout-container.pdf-only .score-pdf-column {
        flex: 1 1 100%;
        max-width: 800px; /* Reduced from 1000px for better proportions */
        margin: 0 auto;
        padding-left: 0;
        padding-right: 0;
        display: block; /* Changed from flex to block for easier navigation */
        text-align: center;
    }
    
    /* Hide video column completely in PDF-only state */
    .score-layout-container.pdf-only .score-video-column {
        display: none !important;
        width: 0 !important;
        min-width: 0 !important;
        max-width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
    }

    /* Better centering for video-only layout */
    .score-layout-container.video-only .score-video-column {
        flex: 1 1 100%;
        max-width: 1200px; /* Increased for better video sizing */
        margin: 0 auto;
        padding-left: 0;
        padding-right: 0;
        display: block; /* Changed from flex to block for easier navigation */
        text-align: center;
        /* ✨ ADDED: Smooth slide-in animation from right (opposite PDF) */
        opacity: 1;
        transform: translateX(0);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        animation: videoSlideIn 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) 0.1s both;
    }

    /* ✨ ADDED: Keyframe animation for video slide-in */
    @keyframes videoSlideIn {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }
    
    /* Hide PDF column completely in video-only state */
    .score-layout-container.video-only .score-pdf-column {
        display: none !important;
        width: 0 !important;
        min-width: 0 !important;
        max-width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
        overflow: hidden !important;
    }

    /* ✨ ADDED: Animation for video column when both are visible */
    .score-layout-container:not(.pdf-only):not(.video-only) .score-video-column {
        opacity: 1;
        transform: translateX(0);
        transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    /* Ensure video content is properly sized in video-only mode */
    .score-layout-container.video-only .composition-score-video-player {
        width: 100%;
        max-width: 100%;
    }
    
    /* Ensure YouTube embeds are properly sized in video-only mode */
    .score-layout-container.video-only .youtube-embed-container {
        width: 100%;
        max-width: 100%;
    }

    /* ===== PDF NAVIGATION STYLES ===== */
    .single-page-score-viewer {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .score-container {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .score-iframe-container {
        flex: 1;
        width: 100%;
        position: relative;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .score-navigation-bottom {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1rem;
        background: var(--gray-50);
        border-top: 1px solid var(--gray-200);
        border-radius: 0 0 8px 8px;
        margin-top: 0.5rem;
    }

    .score-nav-btn {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        background: var(--primary-500);
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 0.9rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .score-nav-btn:hover:not(:disabled) {
        background: var(--primary-600);
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    }

    .score-nav-btn:disabled {
        background: var(--gray-400);
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
    }

    .score-nav-btn .nav-icon {
        font-size: 1.1rem;
        font-weight: bold;
    }

    .score-page-info {
        font-size: 0.9rem;
        font-weight: 600;
        color: var(--gray-700);
        background: white;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        border: 1px solid var(--gray-300);
        min-width: 120px;
        text-align: center;
    }

    /* ===== VIDEO PLAYER STYLES ===== */
    .composition-score-video-container {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .composition-video-player {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    .composition-video-title {
        font-size: 1.1rem;
        font-weight: 600;
        color: var(--gray-800);
        margin-bottom: 1rem;
        text-align: center;
    }

    .youtube-embed-container {
        position: relative;
        width: 100%;
        height: 0;
        padding-bottom: 56.25%; /* 16:9 aspect ratio */
        overflow: hidden;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .youtube-embed-container iframe {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        border: none;
        border-radius: 8px;
    }

    /* ===== LOADING AND ERROR STATES ===== */
    .related-composition-loading,
    .related-composition-empty,
    .related-composition-error {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 2rem 1rem;
        text-align: center;
        color: var(--gray-600);
        width: 100%;
    }

    .related-composition-loading .loading-spinner {
        width: 24px;
        height: 24px;
        border: 2px solid var(--gray-200);
        border-top: 2px solid var(--primary-500);
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin-bottom: 0.75rem;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .related-composition-empty p,
    .related-composition-error p {
        margin: 0;
        font-size: 0.85rem;
    }

    /* ===== RESPONSIVE DESIGN ===== */
    @media (max-width: 768px) {
        .related-works-carousel-component {
            padding: 0 0.5rem;
        }

        .related-works-carousel-container {
            padding: 1rem;
        }

        .related-works-carousel-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .related-composition-card {
            min-width: 160px;
            max-width: 160px;
        }

        .related-composition-image {
            height: 207px; /* 160px width * (11/8.5) = 207px height */
        }

        .related-composition-content {
            padding: 0.5rem;
            text-align: center;
        }

        .related-composition-title {
            font-size: 0.8rem;
            margin: 0 0 0.25rem 0;
        }

        .related-composition-instrumentation {
            font-size: 0.7rem;
        }
    }

    @media (max-width: 480px) {
        .related-composition-card {
            min-width: 140px;
            max-width: 140px;
        }

        .related-composition-image {
            height: 181px; /* 140px width * (11/8.5) = 181px height */
        }

        .related-composition-title {
            font-size: 0.75rem;
            margin: 0 0 0.25rem 0;
        }

        .related-composition-instrumentation {
            font-size: 0.65rem;
        }
    }

    /* Media Preview */
    .media-preview {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .video-thumbnail {
        position: relative;
        border-radius: 8px;
        overflow: hidden;
        aspect-ratio: 16/9;
    }

    .video-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .video-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .video-thumbnail:hover .video-overlay {
        opacity: 1;
    }

    .play-btn {
        background: var(--primary-500);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        font-size: 1.2rem;
        margin-right: 0.5rem;
    }

    .video-duration {
        position: absolute;
        bottom: 0.5rem;
        right: 0.5rem;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.75rem;
    }

    .video-info h4 {
        font-size: 1rem;
        font-weight: 600;
        color: var(--gray-900);
        margin: 0 0 0.25rem 0;
    }

    .video-info p {
        font-size: 0.85rem;
        color: var(--gray-600);
        margin: 0;
    }

    /* Compositions Carousel Section */
    .compositions-carousel-section {
        padding: 4rem 0;
        background: white;
        width: 100vw;
        margin-left: calc(-50vw + 50%);
        position: relative;
    }

    .compositions-carousel-container {
        position: relative;
        margin-top: 2rem;
    }

    .carousel-controls {
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        transform: translateY(-50%);
        display: flex;
        justify-content: space-between;
        pointer-events: none;
        z-index: 10;
    }

    .carousel-btn {
        background: var(--primary-500);
        color: white;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        cursor: pointer;
        font-size: 1.5rem;
        font-weight: bold;
        transition: all 0.3s ease;
        pointer-events: auto;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    .carousel-btn:hover {
        background: var(--primary-600);
        transform: scale(1.1);
    }

    .carousel-btn:disabled {
        background: var(--gray-400);
        cursor: not-allowed;
        transform: none;
    }

    .compositions-carousel {
        display: flex;
        gap: 2rem;
        overflow-x: auto;
        scroll-behavior: smooth;
        padding: 1rem 0;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }

    .compositions-carousel::-webkit-scrollbar {
        display: none;
    }

    .carousel-placeholder {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 200px;
        color: var(--gray-500);
        width: 100%;
    }

    .carousel-indicators {
        display: flex;
        justify-content: center;
        gap: 0.5rem;
        margin-top: 2rem;
    }

    .carousel-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: var(--gray-300);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .carousel-indicator.active {
        background: var(--primary-500);
        transform: scale(1.2);
    }

    /* ===== RESPONSIVE DESIGN SYSTEM ===== */
    
    /* Tablet Breakpoint */
    @media (max-width: 1024px) {
        .highlights-grid {
            gap: 1.5rem;
        }
        
        .highlight-card.catalog-highlight {
            flex: 1.5; /* Slightly more space for catalog on tablets */
        }
        
        .highlight-card.media-highlight {
            flex: 1;
        }
        
        .composition-image {
            flex: 0 0 200px; /* Slightly smaller on tablets */
            height: 260px;
        }
    }

    /* Specific breakpoint for 764px to prevent overlay issues */
    @media (max-width: 764px) {
        .highlights-grid {
            flex-direction: column;
            gap: 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .highlight-card.catalog-highlight,
        .highlight-card.media-highlight {
            flex: 1;
            position: relative;
            z-index: 1;
            width: 100%;
        }

        .highlight-card {
            padding: 1.25rem;
            position: relative;
            z-index: 1;
        }
    }
    
    /* Mobile Breakpoint */
    @media (max-width: 768px) {
        .welcome-title {
            font-size: 2rem;
        }

        .welcome-subtitle {
            font-size: 1.1rem;
        }

        .main-navigation {
            gap: 1rem;
        }

        .nav-card {
            padding: 0.75rem 1.25rem;
            min-width: 100px;
        }

        .nav-card .nav-icon {
            font-size: 1.5rem;
        }

        /* Clean mobile highlights layout */
        .highlights-grid {
            flex-direction: column;
            gap: 1.5rem;
            position: relative;
            z-index: 1;
        }
        
        .highlight-card.catalog-highlight,
        .highlight-card.media-highlight {
            flex: 1;
            position: relative;
            z-index: 1;
        }

        .highlight-card {
            padding: 1.25rem;
            position: relative;
            z-index: 1;
        }

        /* Mobile composition featured layout */
        .composition-featured {
            flex-direction: column;
            align-items: flex-start;
            text-align: left;
            gap: 1.25rem;
            width: 100%;
        }

        .composition-image {
            flex: none;
            width: 100%;
            max-width: 100%;
            height: 240px;
            margin: 0;
            align-self: center; /* Center only the image */
        }

        .composition-img {
            height: 100%;
            width: 100%;
        }
        
        /* Mobile text sizing */
        .composition-title {
            font-size: 1.3rem;
            text-align: left;
            width: 100%;
        }
        
        .composition-instrumentation {
            font-size: 1rem;
            text-align: left;
            width: 100%;
        }
        
        .composition-description {
            font-size: 0.9rem;
            line-height: 1.5;
            text-align: left;
            width: 100%;
        }

        /* Mobile button layout */
        .composition-actions {
            justify-content: flex-start;
            gap: 0.5rem;
            width: 100%;
        }
        
        .btn-primary,
        .btn-buy {
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
        }

        .audio-content {
            flex-direction: column;
            text-align: center;
        }

        .audio-info {
            justify-content: center;
        }

        .carousel-controls {
            display: none;
        }

        .compositions-carousel {
            gap: 1rem;
          }
    }
    
    /* Small Mobile Breakpoint */
    @media (max-width: 480px) {
        .highlight-card {
            padding: 1rem;
        }
        
        .composition-featured {
            gap: 1rem;
            align-items: flex-start;
            text-align: left;
            width: 100%;
        }
        
        .composition-image {
            max-width: 100%;
            height: 200px;
            align-self: center;
        }
        
        .composition-title {
            font-size: 1.2rem;
            text-align: left;
            width: 100%;
        }
        
        .composition-instrumentation {
            font-size: 0.9rem;
            text-align: left;
            width: 100%;
        }
        
        .composition-description {
            font-size: 0.85rem;
            text-align: left;
            width: 100%;
        }
        
        .composition-actions {
            flex-direction: column;
            gap: 0.5rem;
            width: 100%;
            justify-content: flex-start;
        }
        
        .btn-primary,
        .btn-buy {
            width: 100%;
            justify-content: center;
          }
    }
    </style>
</head>

    <body>
        <!-- Navigation -->
        <nav>
    <div class="nav-container">
        <a href="index.html" class="logo">BRANDON DICKS</a>
        <div class="nav-right">
            <ul class="nav-menu">
                <li class="nav-item"><a href="media.html" class="nav-link">Media</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">News</a>
                    <ul class="dropdown-menu">
                        <li><a href="news.html">Latest News</a></li>
                        <li><a href="updates.html">Updates</a></li>
                        <li><a href="events.html">Events</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Teaching Material</a>
                    <ul class="dropdown-menu">
                        <li><a href="exercises.html">Exercises</a></li>
                        <li><a href="tutorials.html">Tutorials</a></li>
                        <li><a href="resources.html">Resources</a></li>
                    </ul>
                </li>
                <li class="nav-item"><a href="about.html" class="nav-link">About</a></li>
                <li class="nav-item dropdown">
                    <a href="#" class="nav-link">Contact</a>
                    <ul class="dropdown-menu">
                        <li><a href="contact.html">Get in Touch</a></li>
                        <li><a href="booking.html">Book a Lesson</a></li>
                        <li><a href="inquiries.html">General Inquiries</a></li>
                    </ul>
                </li>
            </ul>
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
                <svg class="sun-icon" width="18" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <circle cx="12" cy="12" r="5"></circle>
                    <line x1="12" y1="1" x2="12" y2="3"></line>
                    <line x1="12" y1="21" x2="12" y2="23"></line>
                    <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                    <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                    <line x1="1" y1="12" x2="3" y2="12"></line>
                    <line x1="21" y1="12" x2="23" y2="12"></line>
                    <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                    <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
                <svg class="moon-icon" width="18" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                </svg>
            </button>
              <button class="music-catalog-btn"><a href="music-catalog.html">Music Catalog</a></button>
    
              <div class="hamburger">
                <span></span>
                <span></span>   
                <span></span>
        </div>
    </div>
    </div>
</nav>
    
    <!-- Secondary Navigation -->
    <nav class="secondary-nav">
        <div class="secondary-nav-left">
        <a href="/composer" class="secondary-button">Composer</a>
        <a href="/trumpeter" class="secondary-button">Trumpeter</a>
        <a href="/educator" class="secondary-button">Educator</a>
        </div>
        <div class="secondary-nav-right">
            <div class="social-media-links">
                <a href="https://www.youtube.com/@brandondicksmusic" target="_blank" rel="noopener noreferrer" class="social-link" title="YouTube">
                    <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                </a>
                <a href="https://www.instagram.com/brandondicksmusic" target="_blank" rel="noopener noreferrer" class="social-link" title="Instagram">
                    <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                    </svg>
                </a>
                <a href="https://www.facebook.com/brandondicksmusic" target="_blank" rel="noopener noreferrer" class="social-link" title="Facebook">
                    <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                    </svg>
                </a>
                <a href="https://twitter.com/brandondicksmusic" target="_blank" rel="noopener noreferrer" class="social-link" title="Twitter">
                    <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                    </svg>
                </a>
                <a href="https://open.spotify.com/artist/brandondicksmusic" target="_blank" rel="noopener noreferrer" class="social-link" title="Spotify">
                    <svg class="social-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.48.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.42 1.56-.299.421-1.02.599-1.559.3z"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <!-- Loading Overlay Component -->
    <div id="catalog-loading-placeholder" data-component-target="loading-overlay"
         data-container-id="catalog-loading"
         data-title="Loading Music Catalog..."
         data-default-message="Fetching compositions from Notion"
         data-timeout-message="Still loading catalog..."
         data-refresh-button-text="Refresh Page"
         data-success-title="Catalog Loaded!"
         data-success-message="Music catalog loaded successfully"
         data-error-title="Error Loading Catalog"
         data-error-message="Failed to load music catalog"
         data-error-timeout-message="Please try refreshing the page">
    </div>

    <!-- Hero Section -->
    <div class="hero-container">
        <!-- Image Carousel Fallback -->
        <div class="hero-carousel" id="hero-carousel">
            <img 
                src="/Index Photos/CJL07828.JPG" 
                alt="Hero Background - Live Musical Performance" 
                class="hero-fallback-image active"
            >
            <img 
                src="/Index Photos/Playing Photo.jpg" 
                alt="Hero Background - Performance Photo" 
                class="hero-fallback-image"
            >
            <img 
                src="/Index Photos/Letters Playing Photo.png" 
                alt="Hero Background - Letters Performance" 
                class="hero-fallback-image"
            >
            <img 
                src="/Index Photos/[Master Video] Resolutions MVT 1.00_00_21_06.Still001.jpg" 
                alt="Hero Background - Master Video Still" 
                class="hero-fallback-image"
            >
        </div>
        
        <!-- Hero Video - YouTube Embed -->
        <div class="hero-video-container" id="hero-video-container">
            <iframe 
                class="hero-video hero-video-youtube" 
            id="hero-video"
                src="https://www.youtube.com/embed/7LUkFcoO0ME?autoplay=1&mute=1&loop=1&playlist=7LUkFcoO0ME&controls=0&showinfo=0&rel=0&modestbranding=1&iv_load_policy=3&fs=0&disablekb=1"
                frameborder="0" 
                allow="autoplay; encrypted-media; fullscreen" 
                loading="lazy">
            </iframe>
    </div>

        <!-- Content Overlay for Better Readability -->
        <div class="hero-content-overlay"></div>
        
        <!-- Hero Content -->
        <div class="hero-content-wrapper">
            <div class="hero-content-dynamic">

                <div class="hero-rotating-content" id="hero-rotating">
                    <div class="hero-role active" data-role="composer">
                        <h2 class="hero-role-title">Composer</h2>
                        <p class="hero-role-description">Creating original compositions that inspire and challenge musicians</p>
                        <a href="/music-catalog.html" class="explore-btn secondary">
                            🎼 Explore Compositions
                        </a>
</div>
                    <div class="hero-role" data-role="trumpeter">
                        <h2 class="hero-role-title">Trumpeter</h2>
                        <p class="hero-role-description">Bringing brass music to life through performance and artistry</p>
                        <a href="/media.html" class="explore-btn secondary">
                            🎺 View Performances
                        </a>
                    </div>
                    <div class="hero-role" data-role="educator">
                        <h2 class="hero-role-title">Educator</h2>
                        <p class="hero-role-description">Empowering students and organizing musical experiences with innovative tools</p>
                        <a href="/about.html" class="explore-btn secondary">
                            📚 Discover Resources
                        </a>
                    </div>
                </div>
                <div class="hero-nav-dots">
                    <button class="dot active" onclick="switchHeroRole(0)"></button>
                    <button class="dot" onclick="switchHeroRole(1)"></button>
                    <button class="dot" onclick="switchHeroRole(2)"></button>
                </div>
                

            </div>
        </div>
    </div>

    <!-- Main Content Container -->
    <div class="main-content-container">



    <!-- Highlights Section -->
    <section class="highlights-section">
        <div class="container">
            <div class="highlights-grid">

                <!-- New Catalog Release Card -->
                <div class="highlight-card catalog-highlight">
                    <div class="card-content">
                        <div class="catalog-preview" id="new-release-preview">
                            <!-- Loading State -->
                            <div class="new-release-loading" id="new-release-loading">
                                <div class="loading-content">
                                    <div class="loading-image">
                                        <div class="loading-spinner"></div>
                                    </div>
                                    <div class="loading-text">
                                        <h3>Loading New Releases...</h3>
                                        <p>Discovering the latest compositions</p>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Content State (Hidden during loading) -->
                            <div class="composition-featured" id="new-release-content" style="display: none;">
                                <div class="composition-image">
                                    <img src="/imgs/Coming Home (Cover Photo).png" alt="New Release" class="composition-img" id="new-release-cover">
                                </div>
                                <div class="composition-details">
                                    <div class="title-badge-container">
                                        <div class="title-instrumentation-container">
                                            <h4 class="composition-title">Loading...</h4>
                                            <p class="composition-instrumentation">Loading...</p>
                                        </div>
                                        <span class="card-badge">New Releases</span>
                                    </div>
                                    <div class="primary-actions-container">
                                        <button class="btn-primary learn-more-btn" onclick="learnMoreComposition()">
                                            <span class="btn-icon">📖</span>
                                            Learn More
                                        </button>
                                        <button class="btn-buy buy-now-btn" onclick="buyNowComposition()">
                                            <span class="btn-icon">🛒</span>
                                            Buy Now - $19.99
                                        </button>
                                    </div>
                                    <p class="composition-description">Loading composition description...</p>
                                                                    <div class="composition-actions">
                                    <button class="btn-listen listen-btn" onclick="playFeaturedComposition()" id="listen-btn" style="display: none;">
                                        <span class="status-circle"></span>
                                        Listen (Hidden)
                                    </button>
                                    <button class="btn-score score-btn" onclick="viewFeaturedScore()" id="view-score-btn" style="display: none;">
                                        <span class="status-circle"></span>
                                        View Score (Hidden)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Integrated Multi-Audio Player Container -->
                        <div class="new-release-audio-container no-audio" id="new-release-audio-container" style="display: none;">
                            <div class="audio-player-content">
                                <!-- Audio Players Container -->
                                <div class="new-release-audio-players" id="new-release-audio-players">
                                    <div class="audio-loading" style="text-align: center; padding: 1rem; color: var(--gray-600);">
                                        Loading audio players...
                                    </div>
                                </div>
                                
                                <!-- Multi-Audio Navigation Controls -->
                                <div class="new-release-audio-nav-divider" id="new-release-audio-nav-divider" style="display: none; height: 1px; background: var(--gray-200); margin: 0.75rem 0;"></div>
                                <div class="new-release-audio-nav" id="new-release-audio-nav" style="display: none;">
                                    <button class="audio-nav-btn" id="new-release-prev-audio" disabled>
                                        Previous
                                    </button>
                                    <div class="audio-nav-info" id="new-release-audio-nav-info">
                                        Movement 1 of 1
                                    </div>
                                    <button class="audio-nav-btn" id="new-release-next-audio" disabled>
                                        Next
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- New Catalog Release Carousel Navigation -->
                    <div class="new-release-divider"></div>
                    <div class="new-release-carousel-nav">
                        <button class="nav-btn prev-btn" onclick="previousNewRelease()" id="new-release-prev">
                            <span class="nav-icon">←</span>
                            Previous
                        </button>
                        <div class="carousel-dots" id="new-release-dots">
                            <!-- Dots will be generated dynamically -->
                        </div>
                        <button class="nav-btn next-btn" onclick="nextNewRelease()" id="new-release-next">
                            Next
                            <span class="nav-icon">→</span>
                        </button>
                    </div>
                    
                    <!-- Auto-cycle Toggle -->
                    <div class="auto-cycle-toggle" style="display: none;">
                        <label class="toggle-switch">
                            <input type="checkbox" id="new-release-auto-cycle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label">Auto-cycle every 12 seconds</span>
                        <span class="auto-cycle-status" id="auto-cycle-status" style="display: none; color: var(--gray-500); font-size: 0.8rem; margin-left: 1rem;">
                            (Paused - Audio playing)
                        </span>
                    </div>
                </div>

                <!-- Featured Media Card -->
                <div class="highlight-card media-highlight">
                    <div class="card-header">
                        <h3>Featured Media</h3>
                        <span class="card-badge">Popular</span>
                    </div>
                    <div class="card-content">
                        <div class="media-preview">
                            <div class="video-thumbnail">
                                <img src="/Index Photos/CJL07828.JPG" alt="Featured Video" class="video-img">
                                <div class="video-overlay">
                                    <button class="play-btn">▶</button>
                                    <span class="video-duration">3:45</span>
                                </div>
                            </div>
                            <div class="video-info">
                                <h4 class="video-title">Live Performance Highlights</h4>
                                <p class="video-description">Recent performance from Carnegie Hall</p>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer">
                        <a href="/media.html" class="card-link">Watch More →</a>
                    </div>
                </div>
            </div>
        </div>

        <!-- New Release Score Layout Section -->
        <section class="new-release-score-section" id="new-release-score-section" style="display: none;">
            <!-- Score Control Buttons -->
            <div class="score-toggle-container">
                <button class="score-toggle-btn" id="score-toggle-btn" onclick="toggleNewReleaseScorePDF()">
                    <span class="toggle-icon">○</span>
                    <span class="toggle-text">PDF (Hidden)</span>
                </button>
                <button class="score-toggle-btn" id="score-video-toggle-btn" onclick="toggleNewReleaseScoreVideo()">
                    <span class="toggle-icon">○</span>
                    <span class="toggle-text">Score Video (Hidden)</span>
                </button>
            </div>
            
            <div class="score-layout-container" id="score-layout-container">
                <div class="score-pdf-column" id="score-pdf-column">
                    <div class="score-carousel-container" id="score-carousel-container">
                        <!-- Score PDF will be injected here -->
                    </div>
                </div>
                
                <!-- Resizable Divider -->
                <div class="score-divider" id="score-divider">
                    <div class="divider-handle">
                        <div class="divider-grip"></div>
                    </div>
            </div>
                
                <div class="score-video-column" id="score-video-column">
                    <div class="composition-score-video-container" id="composition-score-video-container">
                        <div id="score-video-content">
                            <!-- Score videos will be injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </section>
            
            <!-- Related Works Carousel Component for Featured Compositions -->
            <div class="related-works-carousel-component" id="featured-compositions-carousel">
                <div class="related-works-carousel-container">
                    <h3 class="related-works-carousel-title">Popular Compositions</h3>
                    <div class="related-works-carousel" id="related-works-carousel-featured-compositions">
                        <!-- Content will be populated by JavaScript -->
                        <div class="related-composition-loading">
                            <div class="loading-spinner"></div>
                            <p>Loading popular compositions...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>




            



    <!-- Music Catalog Stats Section -->
    <section id="performances" class="section-showcase" style="scroll-margin-top: 120px;">
        <div class="container">
            <div class="catalog-stats-horizontal">
                    <div class="stat-item featured-stat">
                        <span class="stat-number" id="total-compositions">25+</span>
                        <span class="stat-label">Original Compositions</span>
                        <span class="stat-detail">Across multiple genres</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">8</span>
                        <span class="stat-label">Instrumentation Types</span>
                        <span class="stat-detail">From solo to large ensemble</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number">500+</span>
                        <span class="stat-label">Downloads</span>
                        <span class="stat-detail">By musicians worldwide</span>
                </div>
            </div>
                </div>
            </section>

    <!-- Education & Notion Tools Section -->
    <section id="education" class="section-showcase alt-bg" style="scroll-margin-top: 120px;">
        <div class="container">
            <h2 class="section-title">📚 Education & Innovation</h2>
            <div class="education-grid">
                <div class="education-card">
                    <div class="card-icon">🎓</div>
                    <h3>Teaching Excellence</h3>
                    <p>Dedicated to developing the next generation of musicians through personalized instruction and innovative teaching methods.</p>
                    <a href="/teaching" class="card-link">Learn More →</a>
        </div>
                <div class="education-card">
                    <div class="card-icon">🗂️</div>
                    <h3>Notion Integration</h3>
                    <p>Streamlining music organization and student management with custom Notion databases and automation workflows.</p>
                    <a href="/notion-tools" class="card-link">Explore Tools →</a>
                </div>
                <div class="education-card">
                    <div class="card-icon">🎼</div>
                    <h3>Resource Library</h3>
                    <p>Comprehensive collection of exercises, etudes, and educational materials for brass players at all levels.</p>
                    <a href="/resources" class="card-link">Browse Library →</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="testimonials-section">
        <div class="container">
            <h2 class="section-title">What Others Say</h2>
            <div class="testimonials-grid">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"Brandon's compositions are both challenging and rewarding. His understanding of brass techniques is exceptional."</p>
                    </div>
                    <div class="testimonial-author">
                        <strong>Dr. Sarah Williams</strong>
                        <span>Principal Trumpet, Metro Symphony</span>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"The Notion organization system Brandon created has revolutionized how we manage our music library and student progress."</p>
                    </div>
                    <div class="testimonial-author">
                        <strong>Mark Thompson</strong>
                        <span>Director of Bands, Central High School</span>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"Brandon's teaching approach helped me develop confidence and technical skills I never thought possible."</p>
                    </div>
                    <div class="testimonial-author">
                        <strong>Emily Chen</strong>
                        <span>Music Student</span>
                    </div>
                </div>
            </div>
        </div>
    </section>



    <!-- Call to Action Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2>Ready to Explore More?</h2>
                <p>Whether you're looking for original compositions, trumpet lessons, or innovative music organization solutions, let's connect.</p>
                <div class="cta-buttons">
                    <a href="/music-catalog" class="btn-primary">Browse Full Catalog</a>
                    <a href="/contact" class="btn-secondary">Get in Touch</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-container">
            <!-- Navigation Sections -->
            <div class="footer-nav-section">
                <div class="footer-nav-groups">
                    <div class="footer-nav-group">
                        <h3><a href="/music-catalog.html" class="footer-nav-title">Compositions</a></h3>
                    </div>
                    <div class="footer-nav-group">
                        <h3><a href="/arrangements" class="footer-nav-title">Arrangements</a></h3>
                    </div>
                </div>
                
                <!-- Contact Info -->
                <div class="footer-contact-info">
                    <div class="contact-item">
                        <a href="tel:6786023659" class="contact-link">(678) 602-3659</a>
                    </div>
                    <div class="contact-item">
                        <a href="mailto:BDicksmusic@gmail.com" class="contact-link">BDicksmusic@gmail.com</a>
                    </div>
                </div>
            </div>

            <!-- Newsletter Section -->
            <div class="newsletter-section">
                <h3 class="newsletter-title">Newsletter Sign Up</h3>
                <p class="newsletter-description">
                    Sign up with your email address to receive news and updates about Brandon Dicks, 
                    including releases of new compositions, arrangements, and etudes books.
                </p>
                
                <form class="newsletter-form" id="newsletter-form">
                    <div class="newsletter-input-group">
                        <input 
                            type="email" 
                            placeholder="Email Address" 
                            class="newsletter-input" 
                            id="newsletter-email"
                            required
                        >
                        <button type="submit" class="newsletter-btn">Sign Up</button>
                    </div>
                </form>
                
                <p class="privacy-note">We respect your privacy.</p>
                
                <div class="newsletter-success" id="newsletter-success" style="display: none;">
                    <p>Thank you for signing up to the BDicksmusic mailing list! Look forward to new information about Brandon Dicks coming soon!</p>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="footer-bottom">
            <div class="footer-bottom-nav">
                <a href="/music-catalog.html" class="footer-bottom-link">Music Catalog</a>
                <a href="/teaching" class="footer-bottom-link">Teaching Material</a>
                <a href="/news" class="footer-bottom-link">News</a>
                <a href="/media.html" class="footer-bottom-link">Media</a>
                <a href="/about.html" class="footer-bottom-link">About</a>
                <a href="/contact.html" class="footer-bottom-link">Contact</a>
                <a href="/support" class="footer-bottom-link">Support</a>
            </div>
            
            <div class="footer-bottom-contact">
                <span class="footer-email">BDicksmusic@gmail.com</span>
                <span class="footer-phone">(678) 602-3659</span>
            </div>
        </div>
    </footer>

    <script>
        // Example Data for Local Testing
        const exampleCompositions = [
          {
            id: "1",
            slug: "sunrise-fanfare",
            title: "Sunrise Fanfare",
            instrumentation: "Brass Quintet",
            year: 2022,
            duration: "4:30",
            difficulty: "Medium",
            description: "A bright, energetic piece for brass quintet.",
            tags: ["brass", "fanfare", "modern"],
            coverImage: "/imgs/Coming Home (Cover Photo).png",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 20
          },
          {
            id: "2",
            slug: "nocturne-in-blue",
            title: "Nocturne in Blue",
            instrumentation: "Solo Piano",
            year: 2021,
            duration: "6:00",
            difficulty: "Hard",
            description: "A reflective nocturne for solo piano.",
            tags: ["piano", "nocturne", "contemporary"],
            coverImage: "/imgs/Coming Home (Cover Photo).png",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 15
          },
          {
            id: "3",
            slug: "evening-dance",
            title: "Evening Dance",
            instrumentation: "String Quartet",
            year: 2020,
            duration: "5:15",
            difficulty: "Easy",
            description: "A gentle, lyrical piece for string quartet.",
            tags: ["strings", "quartet", "lyrical"],
            coverImage: "/imgs/Coming Home (Cover Photo).png",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 18
          },
          {
            id: "4",
            slug: "march-of-the-titans",
            title: "March of the Titans",
            instrumentation: "Wind Ensemble",
            year: 2019,
            duration: "7:00",
            difficulty: "Medium",
            description: "A bold, cinematic march for wind ensemble.",
            tags: ["wind", "ensemble", "march"],
            coverImage: "https://via.placeholder.com/350x200?text=March+of+the+Titans",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 22
          },
          {
            id: "5",
            slug: "autumn-leaves",
            title: "Autumn Leaves",
            instrumentation: "Jazz Combo",
            year: 2023,
            duration: "4:45",
            difficulty: "Easy",
            description: "A smooth jazz arrangement for combo.",
            tags: ["jazz", "combo", "autumn"],
            coverImage: "https://via.placeholder.com/350x200?text=Autumn+Leaves",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 16
          },
          {
            id: "6",
            slug: "celestial-waltz",
            title: "Celestial Waltz",
            instrumentation: "Orchestra",
            year: 2018,
            duration: "8:30",
            difficulty: "Hard",
            description: "A sweeping waltz for full orchestra.",
            tags: ["orchestra", "waltz", "celestial"],
            coverImage: "https://via.placeholder.com/350x200?text=Celestial+Waltz",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 25
          },
          {
            id: "7",
            slug: "midnight-groove",
            title: "Midnight Groove",
            instrumentation: "Saxophone Quartet",
            year: 2022,
            duration: "3:50",
            difficulty: "Medium",
            description: "A funky, rhythmic piece for sax quartet.",
            tags: ["saxophone", "quartet", "groove"],
            coverImage: "https://via.placeholder.com/350x200?text=Midnight+Groove",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 17
          },
          {
            id: "8",
            slug: "winter-solstice",
            title: "Winter Solstice",
            instrumentation: "Chamber Choir",
            year: 2021,
            duration: "6:10",
            difficulty: "Medium",
            description: "A serene choral work for winter.",
            tags: ["choir", "chamber", "winter"],
            coverImage: "https://via.placeholder.com/350x200?text=Winter+Solstice",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 19
          },
          {
            id: "9",
            slug: "rising-sun",
            title: "Rising Sun",
            instrumentation: "Solo Flute",
            year: 2020,
            duration: "2:30",
            difficulty: "Easy",
            description: "A bright solo for flute.",
            tags: ["flute", "solo", "sunrise"],
            coverImage: "https://via.placeholder.com/350x200?text=Rising+Sun",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 10
          },
          {
            id: "10",
            slug: "desert-mirage",
            title: "Desert Mirage",
            instrumentation: "Percussion Ensemble",
            year: 2017,
            duration: "5:40",
            difficulty: "Medium",
            description: "A mysterious, evocative piece for percussion.",
            tags: ["percussion", "ensemble", "desert"],
            coverImage: "https://via.placeholder.com/350x200?text=Desert+Mirage",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 21
          },
          {
            id: "11",
            slug: "spring-awakening",
            title: "Spring Awakening",
            instrumentation: "Clarinet Trio",
            year: 2023,
            duration: "4:20",
            difficulty: "Easy",
            description: "A lively trio for clarinets.",
            tags: ["clarinet", "trio", "spring"],
            coverImage: "https://via.placeholder.com/350x200?text=Spring+Awakening",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 14
          },
          {
            id: "12",
            slug: "harbor-lights",
            title: "Harbor Lights",
            instrumentation: "Brass Ensemble",
            year: 2019,
            duration: "6:50",
            difficulty: "Medium",
            description: "A shimmering brass ensemble work.",
            tags: ["brass", "ensemble", "harbor"],
            coverImage: "https://via.placeholder.com/350x200?text=Harbor+Lights",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 20
          },
          {
            id: "13",
            slug: "mountain-echoes",
            title: "Mountain Echoes",
            instrumentation: "Solo Horn",
            year: 2022,
            duration: "3:10",
            difficulty: "Medium",
            description: "A solo horn piece inspired by mountains.",
            tags: ["horn", "solo", "mountain"],
            coverImage: "https://via.placeholder.com/350x200?text=Mountain+Echoes",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 13
          },
          {
            id: "14",
            slug: "city-lights",
            title: "City Lights",
            instrumentation: "Big Band",
            year: 2021,
            duration: "5:00",
            difficulty: "Hard",
            description: "A vibrant big band chart.",
            tags: ["big band", "jazz", "city"],
            coverImage: "https://via.placeholder.com/350x200?text=City+Lights",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 23
          },
          {
            id: "15",
            slug: "forest-whispers",
            title: "Forest Whispers",
            instrumentation: "Woodwind Quintet",
            year: 2020,
            duration: "4:55",
            difficulty: "Easy",
            description: "A gentle piece for woodwind quintet.",
            tags: ["woodwind", "quintet", "forest"],
            coverImage: "https://via.placeholder.com/350x200?text=Forest+Whispers",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 15
          },
          {
            id: "16",
            slug: "river-run",
            title: "River Run",
            instrumentation: "Solo Violin",
            year: 2018,
            duration: "3:30",
            difficulty: "Medium",
            description: "A flowing solo for violin.",
            tags: ["violin", "solo", "river"],
            coverImage: "https://via.placeholder.com/350x200?text=River+Run",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 12
          },
          {
            id: "17",
            slug: "golden-fields",
            title: "Golden Fields",
            instrumentation: "String Orchestra",
            year: 2017,
            duration: "6:20",
            difficulty: "Medium",
            description: "A pastoral work for string orchestra.",
            tags: ["strings", "orchestra", "fields"],
            coverImage: "https://via.placeholder.com/350x200?text=Golden+Fields",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 19
          },
          {
            id: "18",
            slug: "firefly-nights",
            title: "Firefly Nights",
            instrumentation: "Solo Guitar",
            year: 2023,
            duration: "2:45",
            difficulty: "Easy",
            description: "A light, sparkling solo for guitar.",
            tags: ["guitar", "solo", "firefly"],
            coverImage: "https://via.placeholder.com/350x200?text=Firefly+Nights",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 11
          },
          { id: "19",
            slug: "the-stars-and-stripes-forever",
            title: "The Stars and Stripes Forever",
            instrumentation: "Solo Guitar",
            year: 2023,
            duration: "2:45",
            difficulty: "Easy",
            description: "A light, sparkling solo for guitar.",
            tags: ["guitar", "solo", "firefly"],
            coverImage: "https://via.placeholder.com/350x200?text=Firefly+Nights",
            paymentLink: "",
            stripeProductId: "",
            stripePriceId: "",
            price: 11
          }
        ];
        function enableCardClicks() {
            const cards = document.querySelectorAll('.work-card');
            cards.forEach(card => {
                card.addEventListener('click', function(e) {
                    // Only navigate if not clicking a button inside the card
                    if (e.target.tagName === 'BUTTON' || e.target.closest('button')) return;
                    const slug = this.getAttribute('data-slug');
                    if (slug) {
                        window.location.href = `/composition/${slug}`;
                    }
                });
            });
        }
        
        // Load Featured Composition for Highlights
        async function loadFeaturedComposition() {
            try {
                const response = await fetch('/api/compositions');
                const data = await response.json();
                
                if (data && data.success && data.compositions && data.compositions.length > 0) {
                    // Find the first featured composition or use the first one
                    const featured = data.compositions.find(comp => comp.popular || comp.featured) || data.compositions[0];
                    
                    // Update the featured composition display
                    const featuredTitle = document.querySelector('.featured-title');
                    const featuredInstrumentation = document.querySelector('.featured-instrumentation');
                    const featuredDescription = document.querySelector('.featured-description');
                    const featuredLink = document.querySelector('.featured-link');
                    const featuredImg = document.querySelector('.composition-highlight-img');
                    const totalCompositions = document.getElementById('total-compositions');
                    const featuredDifficulty = document.getElementById('featured-difficulty');
                    const featuredYear = document.getElementById('featured-year');
                    
                    // Update content
                    if (featuredTitle) featuredTitle.textContent = featured.title;
                    if (featuredInstrumentation) featuredInstrumentation.textContent = featured.instrumentation;
                    if (featuredDescription) {
                        featuredDescription.textContent = featured.description || 
                            `A ${featured.difficulty || 'beautiful'} composition for ${featured.instrumentation}${featured.year ? ` from ${featured.year}` : ''}.`;
                    }
                    if (featuredLink) featuredLink.href = `/composition/${featured.slug}`;
                    if (featuredImg && featured.coverImage) featuredImg.src = featured.coverImage;
                    if (totalCompositions) totalCompositions.textContent = `${data.compositions.length}+`;
                    if (featuredDifficulty) featuredDifficulty.textContent = featured.difficulty || 'Medium';
                    if (featuredYear) featuredYear.textContent = featured.year || '2024';
                    
                    // Setup audio preview if available
                    setupAudioPreview(featured);
                    
                    console.log('Featured composition loaded:', featured.title);
                }
            } catch (error) {
                console.log('Could not load featured composition, using fallback');
            }
        }

        // Setup Audio Preview Functionality
        function setupAudioPreview(composition) {
            const playBtn = document.getElementById('featured-play-btn');
            const audioContainer = document.getElementById('featured-audio-container');
            const audioPlayer = document.getElementById('featured-audio-player');
            
            if (!playBtn || !audioContainer || !audioPlayer) return;
            
            // Check if composition has audio
            const audioUrl = composition.audioLink || 
                           (composition.audioFiles && composition.audioFiles.length > 0 ? composition.audioFiles[0].url : null);
            
            if (audioUrl) {
                console.log('Audio preview available for:', composition.title);
                
                // Update audio source
                audioPlayer.src = audioUrl;
                
                // Handle preview button click
                playBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    if (audioContainer.style.display === 'none') {
                        // Show audio player
                        audioContainer.style.display = 'block';
                        audioPlayer.play();
                        
                        // Update button text
                        const playText = playBtn.querySelector('.play-text');
                        if (playText) playText.textContent = 'Now Playing';
                        
                        // Smooth scroll to audio player
                        setTimeout(() => {
                            audioContainer.scrollIntoView({ 
                                behavior: 'smooth', 
                                block: 'nearest' 
                            });
                        }, 300);
                    } else {
                        // Toggle play/pause
                        if (audioPlayer.paused) {
                            audioPlayer.play();
                        } else {
                            audioPlayer.pause();
                        }
                    }
                });
                
                // Handle audio events
                audioPlayer.addEventListener('play', function() {
                    const playText = playBtn.querySelector('.play-text');
                    if (playText) playText.textContent = 'Playing';
                });
                
                audioPlayer.addEventListener('pause', function() {
                    const playText = playBtn.querySelector('.play-text');
                    if (playText) playText.textContent = 'Paused';
                });
                
                audioPlayer.addEventListener('ended', function() {
                    const playText = playBtn.querySelector('.play-text');
                    if (playText) playText.textContent = 'Preview';
                });
                
                // Show play button
                playBtn.style.display = 'flex';
            } else {
                console.log('No audio preview available for:', composition.title);
                // Hide play button if no audio
                playBtn.style.display = 'none';
            }
        }

        // Enhanced Featured Compositions System
        let featuredCompositions = [];
        let currentFeaturedIndex = 0;
        let currentAudioIndex = 0;
        let currentVideoIndex = 0;
        let autoCycleInterval = null;
        let isScoreViewerOpen = false;

        async function loadFeaturedCompositions() {
            // Show loading overlay
            if (window.showLoading_catalog_loading) {
                window.showLoading_catalog_loading();
            }
            
            try {
                const response = await fetch('/api/compositions');
                const data = await response.json();
                
                if (data && data.success && data.compositions && data.compositions.length > 0) {
                    // Get featured compositions
                    featuredCompositions = data.compositions.filter(comp => comp.featured || comp.popular);
                    
                    // If no featured compositions, use first 4 compositions
                    if (featuredCompositions.length === 0) {
                        featuredCompositions = data.compositions.slice(0, 4);
                    }
                    
                    console.log('Loaded featured compositions:', featuredCompositions.length);
                    
                    initializeFeaturedDisplay();
                    
                    // Hide loading overlay on success
                    if (window.hideLoading_catalog_loading) {
                        window.hideLoading_catalog_loading();
                    }
                } else {
                    // Fallback to example data
                    featuredCompositions = exampleCompositions.slice(0, 4);
                    initializeFeaturedDisplay();
                    
                    // Hide loading overlay on fallback success
                    if (window.hideLoading_catalog_loading) {
                        window.hideLoading_catalog_loading();
                    }
                }
            } catch (error) {
                console.error('Error loading featured compositions:', error);
                
                // Show error in loading overlay
                if (window.showLoadingError_catalog_loading) {
                    window.showLoadingError_catalog_loading('Failed to load music catalog');
                }
                
                featuredCompositions = exampleCompositions.slice(0, 4);
                initializeFeaturedDisplay();
            }
        }


        function renderAudioSection(comp) {
            const audioFiles = comp.audioFiles || [];
            const hasLegacyAudio = comp.audioLink && audioFiles.length === 0;
            const totalAudio = audioFiles.length || (hasLegacyAudio ? 1 : 0);
            
            if (totalAudio === 0) return '';
            
            return `
                <div class="featured-audio-section">
                    <div class="audio-header">
                        <span class="audio-icon">🎵</span>
                        <span class="audio-title">Audio Preview</span>
                    </div>
                    ${totalAudio > 1 ? `
                        <div class="audio-controls">
                            <button class="audio-nav-btn" onclick="previousAudio()" id="prev-audio">‹</button>
                            <div class="audio-info" id="audio-info">Track 1 of ${totalAudio}</div>
                            <button class="audio-nav-btn" onclick="nextAudio()" id="next-audio">›</button>
                        </div>
                    ` : ''}
                    ${renderAudioPlayer(comp)}
                </div>
            `;
        }

        function renderAudioPlayer(comp) {
            const audioFiles = comp.audioFiles || [];
            const hasLegacyAudio = comp.audioLink && audioFiles.length === 0;
            
            if (audioFiles.length > 0) {
                const currentAudio = audioFiles[currentAudioIndex] || audioFiles[0];
                return `
                    <audio class="featured-audio-player" controls preload="metadata">
                        <source src="${currentAudio.url}" type="audio/mpeg">
                        <source src="${currentAudio.url}" type="audio/wav">
                        <source src="${currentAudio.url}" type="audio/mp4">
                        Your browser does not support the audio element.
                    </audio>
                `;
            } else if (hasLegacyAudio) {
                return `
                    <audio class="featured-audio-player" controls preload="metadata">
                        <source src="${comp.audioLink}" type="audio/mpeg">
                        <source src="${comp.audioLink}" type="audio/wav">
                        <source src="${comp.audioLink}" type="audio/mp4">
                        Your browser does not support the audio element.
                    </audio>
                `;
            }
            
            return '<p style="text-align: center; color: var(--gray-500);">No audio preview available</p>';
        }

        function setupMediaControls(comp) {
            const audioFiles = comp.audioFiles || [];
            const hasLegacyAudio = comp.audioLink && audioFiles.length === 0;
            const totalAudio = audioFiles.length || (hasLegacyAudio ? 1 : 0);
            
            // Update audio navigation buttons
            const prevBtn = document.getElementById('prev-audio');
            const nextBtn = document.getElementById('next-audio');
            
            if (prevBtn && nextBtn && totalAudio > 1) {
                prevBtn.disabled = currentAudioIndex === 0;
                nextBtn.disabled = currentAudioIndex >= totalAudio - 1;
            }
        }

        function createIndicators() {
            const container = document.getElementById('featured-indicators');
            container.innerHTML = featuredCompositions.map((_, index) => `
                <span class="indicator-dot ${index === currentFeaturedIndex ? 'active' : ''}" 
                      onclick="goToFeatured(${index})"></span>
                `).join('');
        }

        // Helper functions for composition actions
        function learnMore(slug) {
            window.location.href = `/composition/${slug}`;
        }

        function viewScore(scoreUrl) {
            if (scoreUrl) {
                window.open(scoreUrl, '_blank');
            } else {
                alert('Score not available for this composition.');
            }
        }



        function previousAudio() {
            const comp = featuredCompositions[currentFeaturedIndex];
            const audioFiles = comp.audioFiles || [];
            const totalAudio = audioFiles.length;
            
            if (totalAudio > 1 && currentAudioIndex > 0) {
                currentAudioIndex--;
                updateAudioPlayer(comp);
                setupMediaControls(comp);
                updateAudioInfo();
            }
        }

        function nextAudio() {
            const comp = featuredCompositions[currentFeaturedIndex];
            const audioFiles = comp.audioFiles || [];
            const totalAudio = audioFiles.length;
            
            if (totalAudio > 1 && currentAudioIndex < totalAudio - 1) {
                currentAudioIndex++;
                updateAudioPlayer(comp);
                setupMediaControls(comp);
                updateAudioInfo();
            }
        }

        function updateAudioPlayer(comp) {
            const audioPlayer = document.querySelector('.featured-audio-player');
            const audioFiles = comp.audioFiles || [];
            
            if (audioPlayer && audioFiles.length > 0) {
                const currentAudio = audioFiles[currentAudioIndex];
                audioPlayer.src = '';
                audioPlayer.innerHTML = `
                    <source src="${currentAudio.url}" type="audio/mpeg">
                    <source src="${currentAudio.url}" type="audio/wav">
                    <source src="${currentAudio.url}" type="audio/mp4">
                    Your browser does not support the audio element.
                `;
                audioPlayer.load();
            }
        }

        function updateAudioInfo() {
            const comp = featuredCompositions[currentFeaturedIndex];
            const audioFiles = comp.audioFiles || [];
            const audioInfo = document.getElementById('audio-info');
            
            if (audioInfo && audioFiles.length > 1) {
                audioInfo.textContent = `Track ${currentAudioIndex + 1} of ${audioFiles.length}`;
            }
        }



        // Action Functions
        function learnMore(slug) {
            window.location.href = `/composition/${slug}`;
        }

        // Newsletter Form Handling
        document.addEventListener('DOMContentLoaded', function() {
            const newsletterForm = document.getElementById('newsletter-form');
            const newsletterEmail = document.getElementById('newsletter-email');
            const newsletterSuccess = document.getElementById('newsletter-success');
            
            if (newsletterForm) {
                newsletterForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const email = newsletterEmail.value.trim();
                    if (!email) {
                        alert('Please enter a valid email address.');
                        return;
                    }
                    
                    // Simulate newsletter signup
                    const submitBtn = this.querySelector('.newsletter-btn');
                    const originalText = submitBtn.textContent;
                    
                    submitBtn.textContent = 'Signing Up...';
                    submitBtn.disabled = true;
                    
                    // Simulate API call delay
                    setTimeout(() => {
                        // Reset form
                        newsletterEmail.value = '';
                        
                        // Show success message
                        newsletterSuccess.style.display = 'block';
                        
                        // Reset button
                        submitBtn.textContent = originalText;
                        submitBtn.disabled = false;
                        
                        // Hide success message after 5 seconds
                        setTimeout(() => {
                            newsletterSuccess.style.display = 'none';
                        }, 5000);
                        
                        console.log('Newsletter signup for:', email);
                    }, 1500);
                });
            }
        });

        function toggleScoreViewer(scoreLink) {
            const scoreSection = document.getElementById('score-section');
            const scoreIframe = document.getElementById('score-iframe');
            
            if (!scoreLink || scoreLink.trim() === '') {
                alert('Score preview is not available for this composition.');
                return;
            }
            
            if (isScoreViewerOpen) {
                scoreSection.classList.remove('active');
                isScoreViewerOpen = false;
            } else {
                // Load score in iframe
                scoreIframe.src = `/pdfjs/web/viewer.html?file=${encodeURIComponent(scoreLink)}#page=1&zoom=page-fit&toolbar=1&navpanes=0`;
                scoreSection.classList.add('active');
                isScoreViewerOpen = true;
                
                // Smooth scroll to score section
                setTimeout(() => {
                    scoreSection.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'start' 
                    });
                }, 300);
            }
        }

        async function buyNow(compositionId, title, price) {
            try {
                const confirmed = confirm(`Purchase "${title}" for $${price}?\n\nYou'll be redirected to checkout.`);
                
                if (confirmed) {
                    const response = await fetch('/api/create-checkout-session', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ compositionId: compositionId })
                    });
                    
                    const data = await response.json();
                    
                    if (data.checkoutUrl) {
                        window.location.href = data.checkoutUrl;
                    } else {
                        alert('Error creating checkout session. Please try again.');
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error processing purchase. Please try again.');
            }
        }

        // Purchase with Stripe integration
        async function purchaseWithStripe(compositionId, title, price) {
            try {
                const confirmed = confirm(`Purchase "${title}" for ${price}?\n\nYou'll be redirected to Stripe checkout.`);
                
                if (confirmed) {
                    const response = await fetch('/api/create-checkout-session', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ compositionId: compositionId })
                    });
                    
                    const data = await response.json();
                    
                    if (data.checkoutUrl) {
                        window.location.href = data.checkoutUrl;
                    } else {
                        alert('Error creating checkout session. Please try again.');
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Error processing purchase. Please try again.');
            }
        }

        // Show unavailable message
        function showUnavailableMessage(title) {
            alert(`"${title}" is currently not available for purchase.\n\nPlease contact us directly for more information about acquiring this composition.`);
        }

        // Purchase function for Stripe integration
        function purchaseComposition(paymentLink, title) {
            try {
                if (paymentLink && (paymentLink.includes('stripe.com') || paymentLink.includes('buy.stripe.com'))) {
                    const confirmed = confirm(`Purchase "${title}"?\n\nYou'll be redirected to Stripe to complete your payment.`);
                    
                    if (confirmed) {
                        window.open(paymentLink, '_blank');
                        console.log(`Redirected to payment for: ${title}`);
                    }
                } else {
                    alert('Invalid payment link. Please contact support.');
                }
            } catch (error) {
                console.error('Error processing purchase:', error);
                alert('Sorry, there was an issue. Please try again.');
            }
        }

        // View composition details
        async function viewComposition(slug) {
            try {
                const response = await fetch(`/api/compositions/slug/${slug}`);
                const data = await response.json();
                
                if (data.success) {
                    showCompositionModal(data.composition);
                } else {
                    alert('Failed to load composition details');
                }
            } catch (error) {
                console.error('Error loading composition:', error);
                alert('Error loading composition details');
            }
        }

        // Show composition modal
        function showCompositionModal(comp) {
            const modal = document.createElement('div');
            modal.className = 'modal-overlay';
            modal.innerHTML = `
                <div class="modal-content">
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                    <h2>${comp.title}</h2>
                    <p><strong>Instrumentation:</strong> ${comp.instrumentation}</p>
                    ${comp.year ? `<p><strong>Year:</strong> ${comp.year}</p>` : ''}
                    <p><strong>Description:</strong> ${comp.description}</p>
                    
                    <div class="modal-links">
                        ${comp.audioLink ? `<a href="${comp.audioLink}" target="_blank" class="btn-secondary">🎵 Listen</a>` : ''}
                        ${comp.scoreLink ? `<a href="${comp.scoreLink}" target="_blank" class="btn-secondary">📄 View Score</a>` : ''}
                        
                        ${comp.paymentLink ? `
                            <button class="btn-primary payment-btn" onclick="purchaseComposition('${comp.paymentLink}', '${comp.title.replace(/'/g, "\\'")}')">
                                💳 Buy Now
                            </button>
                        ` : comp.purchaseLink ? `
                            <a href="${comp.purchaseLink}" target="_blank" class="btn-primary">💳 Purchase</a>
                        ` : `
                            <button class="btn-disabled" onclick="showUnavailableMessage('${comp.title.replace(/'/g, "\\'")}')">
                                🚫 Currently Not Available
                            </button>
                        `}
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // Close modal
        function closeModal() {
            const modal = document.querySelector('.modal-overlay');
            if (modal) {
                modal.remove();
            }
        }

        // Utility functions
        function showLoading(containerId) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = '<div class="loading">Loading compositions...</div>';
            }
        }

        function showError(containerId, message) {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = `<div class="error">${message}</div>`;
            }
        }

        function scrollWorks(direction) {
            const grid = document.getElementById('popular-works');
            if (!grid) return;
            // Find the width of a card or use a default
            const card = grid.querySelector('.work-card');
            const scrollAmount = card ? card.offsetWidth + 24 : 320; // 24px gap or fallback
            grid.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }

        // Enhanced Video Loading and Fallback Logic with Retry Mechanism
        let heroCarouselInitialized = false;
        let videoRetryCount = 0;
        const maxVideoRetries = 3;
        let videoRetryTimeout;
        
        function initHeroVideo() {
            const videoContainer = document.getElementById('hero-video-container');
            const carousel = document.getElementById('hero-carousel');
            const fallbackImages = document.querySelectorAll('.hero-fallback-image');
            
            if (!videoContainer || !carousel) {
                console.log('Hero video container or carousel not found');
                initHeroCarousel(); // Fallback to carousel
                return;
            }
            
            console.log(`Initializing hero YouTube video... (attempt ${videoRetryCount + 1}/${maxVideoRetries})`);
            
            // Start with carousel active as fallback
            if (!heroCarouselInitialized) {
                initHeroCarousel();
            }
            
            // Check if YouTube video ID is set
            const iframe = videoContainer.querySelector('iframe');
            if (!iframe || iframe.src.includes('YOUR_VIDEO_ID')) {
                console.log('⚠️ YouTube video ID not set - using carousel fallback');
                initHeroCarousel();
                return;
            }
            
            console.log('✅ YouTube video ID found:', iframe.src.match(/embed\/([^?]+)/)?.[1] || 'unknown');
            
            // Set a timeout for YouTube iframe loading
            const videoTimeout = setTimeout(() => {
                console.log('YouTube video loading timeout - checking retry options');
                
                if (videoRetryCount < maxVideoRetries - 1) {
                    // Retry video loading
                    videoRetryCount++;
                    console.log(`⏳ Retrying YouTube video in 2 seconds... (attempt ${videoRetryCount + 1}/${maxVideoRetries})`);
                    
                    videoRetryTimeout = setTimeout(() => {
                        initHeroVideo(); // Recursive retry
                    }, 2000);
                } else {
                    // Max retries reached - use carousel permanently
                    console.log('❌ Max video retries reached - using carousel fallback');
                    
                    // Hide video container and ensure carousel is visible
                    videoContainer.style.display = 'none';
                    fallbackImages.forEach(img => {
                        img.classList.remove('hidden');
                    });
                    
                    if (!heroCarouselInitialized) {
                        initHeroCarousel();
                    }
                }
            }, 3000); // YouTube typically loads faster than regular video
            
            // Simulate successful YouTube loading after a short delay
            setTimeout(() => {
                console.log('✅ YouTube video assumed loaded - hiding carousel');
                clearTimeout(videoTimeout);
                clearTimeout(videoRetryTimeout);
                videoRetryCount = 0; // Reset retry count on success
                
                // Hide fallback images and show video
                fallbackImages.forEach(img => {
                    img.classList.add('hidden');
                });
                
                // Show and animate the video container
                setTimeout(() => {
                    videoContainer.classList.add('loaded');
                }, 300);
                
            }, 1500); // Give YouTube embed time to initialize
        }

        // Enhanced smooth scroll function that waits for content
        async function smoothScrollTo(targetId) {
            const target = document.querySelector(targetId);
            if (!target) {
                console.log('Target not found:', targetId);
                return;
            }
            
            // Pause hero rotation when user navigates
            if (heroRotationInterval) {
                clearInterval(heroRotationInterval);
            }
            
            // Wait a bit for any dynamic content to load
            await new Promise(resolve => setTimeout(resolve, 100));
            
            // Check if the carousel has loaded content for compositions section
            if (targetId === '#compositions') {
            const carousel = document.getElementById('popular-works');
            if (carousel && carousel.innerHTML.includes('Loading compositions...')) {
                // Wait for compositions to load
                await new Promise(resolve => {
                    const checkLoading = () => {
                        if (!carousel.innerHTML.includes('Loading compositions...')) {
                            resolve();
                        } else {
                            setTimeout(checkLoading, 100);
                        }
                    };
                    checkLoading();
                });
                }
            }
            
            // Now scroll to the target
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
            
            // Resume hero rotation after scroll
            setTimeout(() => {
                if (!heroRotationInterval) {
                    startHeroRotation();
                }
            }, 1000);
        }

        // Hero Image Carousel
        let carouselInterval;
        
        function initHeroCarousel() {
            // Prevent multiple initializations
            if (heroCarouselInitialized) {
                console.log('Hero carousel already initialized');
                return;
            }
            
            const images = document.querySelectorAll('.hero-fallback-image');
            const videoContainer = document.getElementById('hero-video-container');
            let currentIndex = 0;
            
            console.log('Initializing hero carousel with', images.length, 'images');
            
            if (images.length <= 1) {
                heroCarouselInitialized = true;
                return; // No carousel needed for single image
            }
            
            // Ensure first image is active and all others are hidden
            images.forEach((img, index) => {
                if (index === 0) {
                    img.classList.add('active');
                    img.classList.remove('hidden');
                    img.style.zIndex = '2';
                } else {
                    img.classList.remove('active');
                    img.classList.add('hidden');
                    img.style.zIndex = '1';
                }
            });
            
            function showNextImage() {
                console.log(`Carousel transition: from image ${currentIndex + 1} to next`);
                
                // Hide ALL images first to ensure clean state
                images.forEach((img, index) => {
                    img.classList.remove('active');
                    img.classList.add('hidden');
                    img.style.zIndex = '1';
                });
                
                // Move to next image
                const previousIndex = currentIndex;
                currentIndex = (currentIndex + 1) % images.length;
                
                // Show only the current image
                const currentImg = images[currentIndex];
                currentImg.classList.add('active');
                currentImg.classList.remove('hidden');
                currentImg.style.zIndex = '2';
                
                console.log(`Carousel showing image ${currentIndex + 1} of ${images.length} (was ${previousIndex + 1})`);
                
                // Double-check that the previous image is definitely hidden
                if (previousIndex !== currentIndex) {
                    const prevImg = images[previousIndex];
                    prevImg.classList.remove('active');
                    prevImg.classList.add('hidden');
                    prevImg.style.zIndex = '1';
                }
            }
            
            function startCarousel() {
                // Clear any existing interval
                if (carouselInterval) {
                    clearInterval(carouselInterval);
                }
                // Start carousel with 4-second intervals
                carouselInterval = setInterval(showNextImage, 4000);
                console.log('Carousel started');
            }
            
            function stopCarousel() {
                if (carouselInterval) {
                    clearInterval(carouselInterval);
                    carouselInterval = null;
                    console.log('Carousel stopped');
                }
            }
            
            // Start carousel immediately
            startCarousel();
            
            // Mark as initialized
            heroCarouselInitialized = true;
            
            // YouTube videos loop automatically, so no need for pause/ended events
            // Carousel will be controlled by the video loading logic
        }

        // Hero Role Rotation
        let currentHeroRole = 0;
        let heroRotationInterval;

        function initHeroRotation() {
            startHeroRotation();
        }

        function startHeroRotation() {
            heroRotationInterval = setInterval(() => {
                switchHeroRole((currentHeroRole + 1) % 3);
            }, 5000); // Switch every 5 seconds
        }

        function switchHeroRole(index) {
            console.log('🎯 Switching hero role to index:', index);
            const roles = document.querySelectorAll('.hero-role');
            const dots = document.querySelectorAll('.dot');
            
            // Remove active class from current role and dot
            roles[currentHeroRole].classList.remove('active');
            dots[currentHeroRole].classList.remove('active');
            
            // Update current index
            currentHeroRole = index;
            
            // Add active class to new role and dot
            roles[currentHeroRole].classList.add('active');
            dots[currentHeroRole].classList.add('active');
            
            // Restart the rotation timer
            clearInterval(heroRotationInterval);
            startHeroRotation();
        }

        // Add click event listeners to ensure buttons are working
        document.addEventListener('DOMContentLoaded', function() {
            // Add click handlers to the navigation dots
            const dots = document.querySelectorAll('.dot');
            dots.forEach((dot, index) => {
                dot.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log('🎯 Dot clicked:', index);
                    switchHeroRole(index);
                });
            });

            // Add click handlers to the explore buttons
            const exploreButtons = document.querySelectorAll('.explore-btn.secondary');
            exploreButtons.forEach((button, index) => {
                button.addEventListener('click', function(e) {
                    console.log('🎯 Explore button clicked:', button.href);
                    // Let the default link behavior work
                });
            });

            console.log('🎯 Hero interaction handlers initialized');
        });

        // Compositions Carousel Functionality
        let compositionsCarousel = [];
        let currentCarouselIndex = 0;

        // ✨ OPTIMIZED: Popular compositions carousel loading with caching
        async function loadCompositionsCarousel() {
            try {
                // ✨ CACHE CHECK: Check if we have cached data
                const cachedData = sessionStorage.getItem('popularCompositionsData');
                const cacheTimestamp = sessionStorage.getItem('popularCompositionsTimestamp');
                const cacheAge = Date.now() - (cacheTimestamp || 0);
                
                // Use cached data if it's less than 5 minutes old
                if (cachedData && cacheAge < 5 * 60 * 1000) {
                    console.log('🚀 Using cached popular compositions data');
                    const data = JSON.parse(cachedData);
                    processPopularCompositionsData(data);
                    return;
                }
                
                console.log('🔄 Fetching fresh popular compositions data...');
                const response = await fetch('/api/compositions?fields=title,instrumentation,coverImage,popular,featured,slug,id');
                const data = await response.json();
                
                // ✨ CACHE: Store the data for future use
                if (data && data.success) {
                    sessionStorage.setItem('popularCompositionsData', JSON.stringify(data));
                    sessionStorage.setItem('popularCompositionsTimestamp', Date.now().toString());
                }
                
                processPopularCompositionsData(data);
            } catch (error) {
                console.error('Error loading compositions for carousel:', error);
                compositionsCarousel = exampleCompositions;
                initializeFeaturedCompositionsCarousel();
            }
        }
        
        // ✨ SEPARATED: Data processing for popular compositions
        function processPopularCompositionsData(data) {
                if (data && data.success && data.compositions && data.compositions.length > 0) {
                    // Filter for compositions marked as "Popular"
                    const popularCompositions = data.compositions.filter(comp => comp.popular === true);
                    
                    if (popularCompositions.length > 0) {
                        compositionsCarousel = popularCompositions;
                        initializeFeaturedCompositionsCarousel();
                    } else {
                        // Fallback to featured compositions if no popular items
                        const featuredCompositions = data.compositions.filter(comp => comp.featured === true);
                        compositionsCarousel = featuredCompositions.length > 0 ? featuredCompositions : data.compositions.slice(0, 6);
                        initializeFeaturedCompositionsCarousel();
                        console.log('No compositions marked as "Popular", using fallback');
                    }
                } else {
                    // Fallback to example data
                compositionsCarousel = exampleCompositions;
                initializeFeaturedCompositionsCarousel();
            }
        }

        function initializeFeaturedCompositionsCarousel() {
            const carouselContainer = document.getElementById('related-works-carousel-featured-compositions');
            
            if (!carouselContainer) {
                console.error('Featured compositions carousel container not found');
                return;
            }

            if (!compositionsCarousel || compositionsCarousel.length === 0) {
                carouselContainer.innerHTML = `
                    <div class="related-composition-empty">
                        <p>No popular compositions available.</p>
                    </div>
                `;
                return;
            }

            const carouselHtml = compositionsCarousel.map(comp => `
                <div class="related-composition-card" onclick="navigateToComposition('${comp.slug || comp.id}')">
                    ${comp.coverImage ? `
                        <img src="${comp.coverImage}" alt="${comp.title}" class="related-composition-image" loading="lazy">
                    ` : `
                        <div class="related-composition-image" style="display: flex; align-items: center; justify-content: center; color: var(--gray-400); font-size: 2rem;">♪</div>
                    `}
                    <div class="related-composition-content">
                        <h4 class="related-composition-title">${comp.title}</h4>
                        <div class="related-composition-instrumentation">${comp.instrumentation}</div>
                    </div>
                </div>
            `).join('');

            carouselContainer.innerHTML = carouselHtml;
            console.log('🎠 Featured compositions carousel populated with:', carouselContainer.children.length, 'cards');
        }

        // Global navigation function for composition cards
        function navigateToComposition(slug) {
            if (slug) {
                window.location.href = `/composition/${slug}`;
            }
        }



        // New Catalog Release Functions
        let newReleaseCompositions = [];
        let currentNewReleaseIndex = 0;
        let newReleaseAutoCycleInterval = null;
        
        // Loading State Management Functions
        function showNewReleaseLoading() {
            const loadingElement = document.getElementById('new-release-loading');
            const contentElement = document.getElementById('new-release-content');
            
            if (loadingElement && contentElement) {
                loadingElement.style.display = 'flex';
                contentElement.style.display = 'none';
                console.log('🔄 Showing new release loading state');
            }
        }

        function hideNewReleaseLoading() {
            const loadingElement = document.getElementById('new-release-loading');
            const contentElement = document.getElementById('new-release-content');
            
            if (loadingElement && contentElement) {
                loadingElement.style.display = 'none';
                contentElement.style.display = 'flex';
                console.log('✅ Hiding new release loading state, showing content');
            }
        }

        // Audio Container State Management System
        const AudioContainerManager = {
            container: null,
            playersContainer: null,
            navContainer: null,
            navDivider: null,
            
            // Initialize the audio container manager
            init() {
                this.container = document.getElementById('new-release-audio-container');
                this.playersContainer = document.getElementById('new-release-audio-players');
                this.navContainer = document.getElementById('new-release-audio-nav');
                this.navDivider = document.getElementById('new-release-audio-nav-divider');
                
                // Ensure audio container starts in hidden state
                if (this.container) {
                    this.container.classList.remove('has-audio');
                    this.container.classList.add('no-audio');
                    this.container.style.display = 'none';
                    console.log('🎵 Audio container initialized in hidden state');
                }
                
                console.log('🎵 Audio Container Manager initialized');
                console.log('🎵 Container elements found:', {
                    container: !!this.container,
                    playersContainer: !!this.playersContainer,
                    navContainer: !!this.navContainer,
                    navDivider: !!this.navDivider
                });
                return this;
            },
            
            // Show audio container with smooth animation
            show() {
                if (!this.container) {
                    console.log('❌ AudioContainerManager.show() - No container found');
                    return;
                }
                
                console.log('🎵 AudioContainerManager.show() - Showing container');
                this.container.classList.remove('no-audio');
                this.container.classList.add('has-audio');
                this.container.style.display = 'block';
                
                console.log('🎵 Audio container shown');
            },
            
            // Hide audio container with smooth animation
            hide() {
                if (!this.container) return;
                
                this.container.classList.remove('has-audio');
                this.container.classList.add('no-audio');
                
                // Hide after animation completes
                setTimeout(() => {
                    if (this.container.classList.contains('no-audio')) {
                this.container.style.display = 'none';
                    }
                }, 300);
                
                console.log('🎵 Audio container hidden');
            },
            
            // Update container state based on audio availability
            updateState(hasAudio) {
                console.log('🎵 AudioContainerManager.updateState called with hasAudio:', hasAudio);
                console.log('🎵 AudioContainerManager container exists:', !!this.container);
                if (hasAudio) {
                    // Don't automatically show - just update the class for button state
                    console.log('🎵 Audio available - container remains hidden by default');
                    this.container.classList.remove('no-audio');
                    this.container.classList.add('has-audio');
                    // Keep display: none - only show when user clicks Listen button
                } else {
                    console.log('🎵 No audio available - hiding container...');
                    this.hide();
                }
            },
            
            // Clear all audio content
            clearContent() {
                if (this.playersContainer) {
                    this.playersContainer.innerHTML = `
                        <div class="audio-loading" style="text-align: center; padding: 1rem; color: var(--gray-600);">
                            Loading audio players...
                        </div>
                    `;
                }
                
                if (this.navContainer) {
                    this.navContainer.style.display = 'none';
                }
                
                if (this.navDivider) {
                    this.navDivider.style.display = 'none';
                }
            },
            
            // Set no audio message
            setNoAudioMessage() {
                if (this.playersContainer) {
                    this.playersContainer.innerHTML = `
                        <div style="padding: 1rem; background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 6px; margin: 0.5rem 0;">
                            <h4 style="color: #856404; margin: 0 0 0.5rem 0;">No Audio Available</h4>
                            <p style="color: #856404; margin: 0; font-size: 0.9rem;">
                                Audio files are not available for this composition.
                            </p>
                        </div>
                    `;
                }
            }
        };

        async function loadNewCatalogRelease() {
            try {
                console.log('🔄 Loading New Catalog Release...');
                
                // Show loading state
                showNewReleaseLoading();
                
                // Optimized API call with specific fields to reduce payload - including score data
                const response = await fetch('/api/compositions?fields=title,instrumentation,description,coverImage,newInCatalog,featured,popular,audioLink,audioFiles,scoreLink,scoreFiles,videoFiles,performedBy,paymentLink,price&includeMedia=true');
                const data = await response.json();
                
                console.log('📊 API Response:', {
                    success: data?.success,
                    totalCompositions: data?.compositions?.length || 0,
                    compositions: data?.compositions?.map(comp => ({
                        title: comp.title,
                        newInCatalog: comp.newInCatalog,
                        featured: comp.featured,
                        popular: comp.popular,
                        scoreLink: comp.scoreLink,
                        scoreFiles: comp.scoreFiles?.length || 0,
                        videoFiles: comp.videoFiles?.length || 0
                    })) || []
                });
                
                if (data && data.success && data.compositions && data.compositions.length > 0) {
                    // Filter for compositions marked as "New in Catalog" - optimized filtering
                    newReleaseCompositions = data.compositions.filter(comp => comp.newInCatalog === true);
                    
                    console.log('🎯 New in Catalog compositions found:', newReleaseCompositions.length);
                    
                    // Reduced logging for performance
                    if (newReleaseCompositions.length > 0) {
                        console.log('📝 First composition:', newReleaseCompositions[0].title);
                    }
                    
                    if (newReleaseCompositions.length > 0) {
                        currentNewReleaseIndex = 0;
                        console.log('🎯 About to update with first composition:', newReleaseCompositions[0].title);
                        updateNewCatalogRelease(newReleaseCompositions[0]);
                        initializeNewReleaseCarousel();
                        startNewReleaseAutoCycle();
                        
                        // Hide loading state and show content
                        hideNewReleaseLoading();
                        
                        console.log('✅ New Catalog Release loaded successfully with', newReleaseCompositions.length, 'compositions');
                    } else {
                        // Fallback to featured or first composition if no "New in Catalog" items
                        const fallbackComposition = data.compositions.find(comp => comp.featured) || data.compositions[0];
                        newReleaseCompositions = [fallbackComposition];
                        currentNewReleaseIndex = 0;
                        updateNewCatalogRelease(fallbackComposition);
                        initializeNewReleaseCarousel();
                        
                        // Hide loading state and show content
                        hideNewReleaseLoading();
                        
                        console.log('⚠️ No compositions marked as "New in Catalog", using fallback:', fallbackComposition?.title);
                    }
                } else {
                    console.log('❌ No compositions data available');
                    // Hide loading state when no data
                    hideNewReleaseLoading();
                }
            } catch (error) {
                console.error('❌ Error loading new catalog release:', error);
                // Hide loading state even on error
                hideNewReleaseLoading();
            }
        }

        function updateNewCatalogRelease(composition) {
            const previewContainer = document.querySelector('#new-release-content .composition-featured');
            const titleElement = document.querySelector('#new-release-content .composition-title');
            const instrumentationElement = document.querySelector('#new-release-content .composition-instrumentation');
            const descriptionElement = document.querySelector('#new-release-content .composition-description');
            const imageElement = document.querySelector('#new-release-content .composition-img');
            
            // ✨ RESET VIEW SCORE TO HIDDEN when composition changes
            const viewScoreBtn = document.getElementById('view-score-btn');
            const scoreSection = document.getElementById('new-release-score-section');
            if (viewScoreBtn && scoreSection) {
                scoreSection.style.display = 'none';
                viewScoreBtn.innerHTML = '<span class="status-circle"></span>View Score (Hidden)';
                viewScoreBtn.classList.remove('in-view');
                console.log('📄 View Score reset to hidden for new composition:', composition.title);
            }
            
            // Add fade out animation
            if (previewContainer) {
                console.log('🎬 Starting animation for:', composition.title);
                previewContainer.classList.add('fade-out');
                
                                    // Update content after fade out - optimized timing
                setTimeout(() => {
                    if (titleElement) titleElement.textContent = composition.title || 'New Release';
                    if (instrumentationElement) instrumentationElement.textContent = composition.instrumentation || 'Brass Ensemble';
                    if (descriptionElement) descriptionElement.textContent = composition.description || 'A dynamic new composition showcasing innovative musical ideas and technical brilliance.';
                        
                        // Handle cover image with default fallback
                        if (imageElement) {
                            const imageContainer = imageElement.parentElement;
                            if (composition.coverImage) {
                                imageElement.src = composition.coverImage;
                                imageElement.style.display = 'block';
                                imageContainer.classList.add('has-image');
                            } else {
                                // Show default cover when no image is available
                                imageElement.style.display = 'none';
                                imageContainer.classList.remove('has-image');
                            }
                        }
                        
                        // Update performed by information
                        const performedByElement = document.querySelector('#new-release-audio-container .performed-by-artist');
                        if (performedByElement) {
                            performedByElement.textContent = composition.performedBy || 'Unknown Artist';
                        }
                        
                        // Check if audio is available and update Listen button and container
                        const listenBtn = document.getElementById('listen-btn');
                        // Check for audio availability - prioritize media database files
                        const hasAudio = (composition.audioFiles && composition.audioFiles.length > 0) || composition.audioLink;
                        
                        // Reduced logging for performance
                        console.log('🎵 Audio available:', hasAudio, 'for:', composition.title);
                        
                        // Update audio container state using the manager
                        AudioContainerManager.updateState(hasAudio);
                        
                        if (listenBtn) {
                            if (hasAudio) {
                                // Show Listen button - always start in hidden state
                                listenBtn.style.display = 'flex';
                                listenBtn.innerHTML = '<span class="status-circle"></span>Listen (Hidden)';
                                listenBtn.classList.remove('in-view');
                                console.log('🎵 Listen button set to hidden state for composition:', composition.title);
                            } else {
                                // Hide Listen button if no audio available
                                listenBtn.style.display = 'none';
                                console.log('🎵 Listen button hidden - no audio available for composition:', composition.title);
                            }
                        }
                        
                                // ✨ Update Buy Now button based on payment link availability
        const buyNowBtn = document.querySelector('#new-release-content .buy-now-btn');
        if (buyNowBtn) {
            if (composition.paymentLink) {
                // Show Buy Now button with actual price
                buyNowBtn.style.display = 'flex';
                buyNowBtn.innerHTML = `<span class="btn-icon">🛒</span>Buy Now - $${composition.price || '19.99'}`;
                buyNowBtn.onclick = () => buyNowComposition();
                console.log('💳 Buy Now button updated with payment link for:', composition.title);
            } else {
                // Show "Currently Not Available" when no payment link
                buyNowBtn.style.display = 'flex';
                buyNowBtn.innerHTML = `<span class="btn-icon">❌</span>Currently Not Available`;
                buyNowBtn.onclick = null; // Disable click functionality
                buyNowBtn.style.opacity = '0.6';
                buyNowBtn.style.cursor = 'not-allowed';
                console.log('⚠️ Buy Now button set to "Currently Not Available" for:', composition.title);
            }
        }

                // ✨ Update View Score button based on score availability
        const viewScoreBtn = document.querySelector('#new-release-content .score-btn');
                        if (viewScoreBtn) {
            // Check for score availability - PDF scores and score videos
            const hasPdfScore = (composition.scoreFiles && composition.scoreFiles.length > 0) || composition.scoreLink;
            const hasScoreVideos = (composition.videoFiles && composition.videoFiles.filter(video => video.type === 'Score Video').length > 0);
            const hasScore = hasPdfScore || hasScoreVideos;
            
                            if (hasScore) {
                // Show View Score button - always start in hidden state
                                viewScoreBtn.style.display = 'flex';
                viewScoreBtn.innerHTML = '<span class="status-circle"></span>View Score (Hidden)';
                viewScoreBtn.classList.remove('in-view');
                console.log('📄 View Score button set to hidden state for composition:', composition.title);
                console.log('📄 Score data found:', {
                    scoreFiles: composition.scoreFiles?.length || 0,
                    scoreLink: composition.scoreLink || 'none',
                    videoFiles: composition.videoFiles?.length || 0,
                    scoreVideos: composition.videoFiles?.filter(video => video.type === 'Score Video').length || 0,
                    hasPdfScore,
                    hasScoreVideos
                });
                            } else {
                                // Hide View Score button if no score available
                                viewScoreBtn.style.display = 'none';
                console.log('📄 View Score button hidden - no score available for composition:', composition.title);
                            }
                        }
                    

                    
                    // Add fade in animation - optimized timing
                    console.log('🎬 Adding fade-in animation');
                    previewContainer.classList.remove('fade-out');
                    previewContainer.classList.add('fade-in');
                    
                    // Remove fade-in class after animation completes - faster timing
                    setTimeout(() => {
                        previewContainer.classList.remove('fade-in');
                    }, 400);
                }, 300);
            } else {
                // Fallback without animation
                if (titleElement) titleElement.textContent = composition.title || 'New Release';
                if (instrumentationElement) instrumentationElement.textContent = composition.instrumentation || 'Brass Ensemble';
                if (descriptionElement) descriptionElement.textContent = composition.description || 'A dynamic new composition showcasing innovative musical ideas and technical brilliance.';
                
                // Handle cover image with default fallback (fallback version)
                if (imageElement) {
                    const imageContainer = imageElement.parentElement;
                    if (composition.coverImage) {
                        imageElement.src = composition.coverImage;
                        imageElement.style.display = 'block';
                        imageContainer.classList.add('has-image');
                    } else {
                        // Show default cover when no image is available
                        imageElement.style.display = 'none';
                        imageContainer.classList.remove('has-image');
                    }
                }
                
                // Update performed by information
                const performedByElement = document.querySelector('#new-release-audio-container .performed-by-artist');
                if (performedByElement) {
                    performedByElement.textContent = composition.performedBy || 'Unknown Artist';
                }
                
                // Check if audio is available and update Listen button
                const listenBtn = document.getElementById('listen-btn');
                const audioContainer = document.getElementById('new-release-audio-container');
                // Check for audio availability - prioritize media database files
                const hasAudio = (composition.audioFiles && composition.audioFiles.length > 0) || composition.audioLink;
                
                if (listenBtn) {
                    if (hasAudio) {
                        // Show Listen button - always start in hidden state
                        listenBtn.style.display = 'flex';
                        listenBtn.innerHTML = '<span class="status-circle"></span>Listen (Hidden)';
                        listenBtn.classList.remove('in-view');
                        console.log('🎵 Listen button set to hidden state (fallback) for composition:', composition.title);
                    } else {
                        // Hide Listen button if no audio available
                        listenBtn.style.display = 'none';
                        console.log('🎵 Listen button hidden - no audio available (fallback) for composition:', composition.title);
                    }
                }
                
                // ✨ Update Buy Now button based on payment link availability (fallback)
                const buyNowBtn = document.querySelector('#new-release-content .buy-now-btn');
                if (buyNowBtn) {
                    if (composition.paymentLink) {
                        // Show Buy Now button with actual price
                        buyNowBtn.style.display = 'flex';
                        buyNowBtn.innerHTML = `<span class="btn-icon">🛒</span>Buy Now - $${composition.price || '19.99'}`;
                        buyNowBtn.onclick = () => buyNowComposition();
                        buyNowBtn.style.opacity = '1';
                        buyNowBtn.style.cursor = 'pointer';
                        console.log('💳 Buy Now button updated with payment link (fallback) for:', composition.title);
                    } else {
                        // Show "Currently Not Available" when no payment link
                        buyNowBtn.style.display = 'flex';
                        buyNowBtn.innerHTML = `<span class="btn-icon">❌</span>Currently Not Available`;
                        buyNowBtn.onclick = null; // Disable click functionality
                        buyNowBtn.style.opacity = '0.6';
                        buyNowBtn.style.cursor = 'not-allowed';
                        console.log('⚠️ Buy Now button set to "Currently Not Available" (fallback) for:', composition.title);
                    }
                }
                
                // ✨ Update View Score button based on score availability (fallback)
                const viewScoreBtn = document.querySelector('#new-release-content .score-btn');
                if (viewScoreBtn) {
                    // Check for score availability - PDF scores and score videos
                    const hasPdfScore = (composition.scoreFiles && composition.scoreFiles.length > 0) || composition.scoreLink;
                    const hasScoreVideos = (composition.videoFiles && composition.videoFiles.filter(video => video.type === 'Score Video').length > 0);
                    const hasScore = hasPdfScore || hasScoreVideos;
                    
                    if (hasScore) {
                        // Show View Score button - always start in hidden state
                        viewScoreBtn.style.display = 'flex';
                        viewScoreBtn.innerHTML = '<span class="status-circle"></span>View Score (Hidden)';
                        viewScoreBtn.classList.remove('in-view');
                        console.log('📄 View Score button set to hidden state (fallback) for composition:', composition.title);
                        console.log('📄 Score data found (fallback):', {
                            scoreFiles: composition.scoreFiles?.length || 0,
                            scoreLink: composition.scoreLink || 'none',
                            videoFiles: composition.videoFiles?.length || 0,
                            scoreVideos: composition.videoFiles?.filter(video => video.type === 'Score Video').length || 0,
                            hasPdfScore,
                            hasScoreVideos
                        });
                    } else {
                        // Hide View Score button if no score available
                        viewScoreBtn.style.display = 'none';
                        console.log('📄 View Score button hidden - no score available (fallback) for composition:', composition.title);
                    }
                }
                

            }
        }

        function initializeNewReleaseCarousel() {
            console.log('🎠 Initializing New Release Carousel...');
            const dotsContainer = document.getElementById('new-release-dots');
            const prevBtn = document.getElementById('new-release-prev');
            const nextBtn = document.getElementById('new-release-next');
            
            console.log('🔍 Carousel elements found:', {
                dotsContainer: !!dotsContainer,
                prevBtn: !!prevBtn,
                nextBtn: !!nextBtn,
                compositionsCount: newReleaseCompositions.length
            });
            
            if (!dotsContainer || !prevBtn || !nextBtn) {
                console.error('❌ Missing carousel elements');
                return;
            }
            
            // Clear existing dots
            dotsContainer.innerHTML = '';
            
            // Create dots for each composition
            newReleaseCompositions.forEach((composition, index) => {
                const dot = document.createElement('div');
                dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
                dot.onclick = () => goToNewRelease(index);
                dotsContainer.appendChild(dot);
                console.log(`🔘 Created dot ${index + 1} for: ${composition.title}`);
            });
            
            // Update button states
            updateNewReleaseNavButtons();
            console.log('✅ New Release Carousel initialized with', newReleaseCompositions.length, 'dots');
        }

        function updateNewReleaseNavButtons() {
            const prevBtn = document.getElementById('new-release-prev');
            const nextBtn = document.getElementById('new-release-next');
            
            // ✨ LOOPING: Always enable buttons since we can loop infinitely
            if (prevBtn) {
                prevBtn.disabled = false;
                console.log('⬅️ Previous button: enabled (looping)');
            }
            if (nextBtn) {
                nextBtn.disabled = false;
                console.log('➡️ Next button: enabled (looping)');
            }
            
            console.log('🎯 Current index:', currentNewReleaseIndex, 'of', newReleaseCompositions.length - 1);
        }

        function updateNewReleaseDots() {
            const dots = document.querySelectorAll('#new-release-dots .carousel-dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentNewReleaseIndex);
            });
        }

        function previousNewRelease() {
            // ✨ LOOPING: Wrap to the end if at the beginning
            if (currentNewReleaseIndex > 0) {
                currentNewReleaseIndex--;
            } else {
                // Loop to the last composition
                currentNewReleaseIndex = newReleaseCompositions.length - 1;
            }
            
            // ✨ ANIMATION: Use the same animation as auto-cycle
            const previewContainer = document.querySelector('#new-release-content .composition-featured');
            if (previewContainer) {
                // Add fade out animation
                previewContainer.classList.add('fade-out');
                
                // Update content after fade out
                setTimeout(() => {
                updateNewCatalogRelease(newReleaseCompositions[currentNewReleaseIndex]);
                updateNewReleaseDots();
                updateNewReleaseNavButtons();
                resetNewReleaseAutoCycle();
                
                // Update audio player if it's visible
                    updateNewReleaseAudioPlayer();
                    
                    // Add fade in animation
                    previewContainer.classList.remove('fade-out');
                    previewContainer.classList.add('fade-in');
                    
                    // Remove fade-in class after animation completes
                    setTimeout(() => {
                        previewContainer.classList.remove('fade-in');
                    }, 600);
                }, 500);
            } else {
                // Fallback without animation
                updateNewCatalogRelease(newReleaseCompositions[currentNewReleaseIndex]);
                updateNewReleaseDots();
                updateNewReleaseNavButtons();
                resetNewReleaseAutoCycle();
                updateNewReleaseAudioPlayer();
                // ✨ RESET SCORE LAYOUT for new composition (fallback)
                resetScoreLayoutForNewComposition();
            }
        }

        function nextNewRelease() {
            // ✨ LOOPING: Wrap to the beginning if at the end
            if (currentNewReleaseIndex < newReleaseCompositions.length - 1) {
                currentNewReleaseIndex++;
            } else {
                // Loop to the first composition
                currentNewReleaseIndex = 0;
            }
            
            // ✨ ANIMATION: Use the same animation as auto-cycle
            const previewContainer = document.querySelector('#new-release-content .composition-featured');
            if (previewContainer) {
                // Add fade out animation
                previewContainer.classList.add('fade-out');
                
                // Update content after fade out
                setTimeout(() => {
                updateNewCatalogRelease(newReleaseCompositions[currentNewReleaseIndex]);
                updateNewReleaseDots();
                updateNewReleaseNavButtons();
                resetNewReleaseAutoCycle();
                
                // Update audio player if it's visible
                    updateNewReleaseAudioPlayer();
                    
                    // Add fade in animation
                    previewContainer.classList.remove('fade-out');
                    previewContainer.classList.add('fade-in');
                    
                    // Remove fade-in class after animation completes
                    setTimeout(() => {
                        previewContainer.classList.remove('fade-in');
                    }, 600);
                }, 500);
            } else {
                // Fallback without animation
                updateNewCatalogRelease(newReleaseCompositions[currentNewReleaseIndex]);
                updateNewReleaseDots();
                updateNewReleaseNavButtons();
                resetNewReleaseAutoCycle();
                updateNewReleaseAudioPlayer();
                // ✨ RESET SCORE LAYOUT for new composition (fallback)
                resetScoreLayoutForNewComposition();
            }
        }

        // ✨ HELPER FUNCTION: Reset score layout for new composition
        function resetScoreLayoutForNewComposition() {
            // Reset PDF navigation state
            newReleaseCurrentPage = 1;
            newReleaseTotalPages = 1;
            
            if (window.newReleaseScoreLayoutManager) {
                const currentComposition = newReleaseCompositions[currentNewReleaseIndex];
                if (currentComposition) {
                    loadNewReleaseScoreData(currentComposition);
                    
                    // Set default state for new composition
                    setTimeout(() => {
                        const hasPdf = (currentComposition.scoreFiles && currentComposition.scoreFiles.length > 0) || currentComposition.scoreLink;
                        const hasScoreVideos = (currentComposition.videoFiles && currentComposition.videoFiles.filter(video => video.type === 'Score Video').length > 0);
                        
                        if (hasScoreVideos) {
                            window.newReleaseScoreLayoutManager.setState('VIDEO_ONLY');
                        } else if (hasPdf) {
                            window.newReleaseScoreLayoutManager.setState('PDF_ONLY');
                        } else {
                            window.newReleaseScoreLayoutManager.setState('HIDDEN');
                        }
                    }, 100);
                }
            }
        }

        function goToNewRelease(index) {
            if (index >= 0 && index < newReleaseCompositions.length) {
                currentNewReleaseIndex = index;
                updateNewCatalogRelease(newReleaseCompositions[currentNewReleaseIndex]);
                updateNewReleaseDots();
                updateNewReleaseNavButtons();
                resetNewReleaseAutoCycle();
                
                // Update audio player if it's visible
                updateNewReleaseAudioPlayer();
                
                // ✨ RESET SCORE LAYOUT for new composition
                resetScoreLayoutForNewComposition();
            }
        }

        // Global variables for new release multi-audio
        let currentNewReleaseAudioIndex = 0;
        let newReleaseAudioFiles = [];

        function updateNewReleaseAudioPlayer() {
            if (!newReleaseCompositions[currentNewReleaseIndex]) {
                console.log('❌ No composition found at index:', currentNewReleaseIndex);
                return;
            }
            
            const composition = newReleaseCompositions[currentNewReleaseIndex];
            console.log('🎵 Updating audio player for composition:', composition.title);
            
            // Parse audio files from the composition
            newReleaseAudioFiles = parseAudioFiles(composition);
            currentNewReleaseAudioIndex = 0;
            
            console.log('🎵 Found audio files:', newReleaseAudioFiles);
            
            if (newReleaseAudioFiles.length === 0) {
                // Use AudioContainerManager to handle no audio state
                AudioContainerManager.setNoAudioMessage();
                return;
            }
            
            // Create audio players
            createNewReleaseAudioPlayers();
            
            // Setup navigation if multiple tracks
            if (newReleaseAudioFiles.length > 1) {
                setupNewReleaseAudioNavigation();
            } else {
                hideNewReleaseAudioNavigation();
            }
            
            // Remove loading state
            removeNewReleaseLoadingState();
            
            console.log('✅ Audio player updated with', newReleaseAudioFiles.length, 'tracks');
        }

        function parseAudioFiles(composition) {
            const audioFiles = [];
            
            console.log('🎵 Parsing audio files for composition:', composition.title);
            console.log('🎵 Composition audio data:', {
                audioLink: composition.audioLink,
                audioFiles: composition.audioFiles,
                audioFilesLength: composition.audioFiles?.length
            });
            
            // Prioritize multiple audio files from media database (more detailed)
            if (composition.audioFiles && Array.isArray(composition.audioFiles) && composition.audioFiles.length > 0) {
                composition.audioFiles.forEach((audioFile, index) => {
                    audioFiles.push({
                        id: audioFile.id || `audio-${index}`,
                        url: audioFile.url,
                        title: audioFile.title || composition.title,
                        performanceBy: audioFile.performanceBy || composition.performedBy || '',
                        duration: audioFile.duration || null
                    });
                    console.log(`🎵 Added audio file ${index + 1}:`, audioFile.title, audioFile.url);
                });
                console.log('🎵 Using media database audio files (', audioFiles.length, 'files)');
            }
            // Fallback to single audio link only if no media database files
            else if (composition.audioLink) {
                audioFiles.push({
                    id: 'audio-link',
                    url: composition.audioLink,
                    title: composition.title,
                    performanceBy: composition.performedBy || '',
                    duration: null
                });
                console.log('🎵 Added single audio link (fallback):', composition.audioLink);
            }
            
            console.log('🎵 Total audio files parsed:', audioFiles.length);
            return audioFiles;
        }

        function createNewReleaseAudioPlayers() {
            if (!AudioContainerManager.playersContainer) return;
            
            const playersHtml = newReleaseAudioFiles.map((audioFile, index) => {
                // Only show movement title for multi-movement pieces
                const isMultiMovement = newReleaseAudioFiles.length > 1;
                const displayTitle = extractMovementTitle(audioFile.title) || audioFile.title;
                
                let titleHtml = '';
                if (isMultiMovement && displayTitle) {
                    titleHtml = `
                        <div class="movement-title">${displayTitle}</div>
                    `;
                }
                
                // Performance info
                let performanceHtml = '';
                if (audioFile.performanceBy) {
                    performanceHtml = `
                        <div class="audio-metadata">
                            <div class="performance-info">Performed by: ${audioFile.performanceBy}</div>
                        </div>
                    `;
                }
                
                return `
                    <div class="new-release-audio-player" data-audio-index="${index}" style="${index === 0 ? 'display: block;' : 'display: none;'}">
                        ${titleHtml}
                        ${performanceHtml}
                        <audio controls preload="metadata" data-audio-id="${audioFile.id}" style="width: 100%; margin-bottom: 0.75rem;">
                            <source src="${audioFile.url}" type="audio/mpeg">
                            <source src="${audioFile.url}" type="audio/mp4">
                            <source src="${audioFile.url}" type="audio/wav">
                            <source src="${audioFile.url}" type="audio/ogg">
                            Your browser does not support the audio element.
                        </audio>
                        ${audioFile.duration ? `<div class="audio-duration">Duration: ${audioFile.duration}</div>` : ''}
                    </div>
                `;
            }).join('');
            
            AudioContainerManager.playersContainer.innerHTML = playersHtml;
        }

        function setupNewReleaseAudioNavigation() {
            const prevBtn = document.getElementById('new-release-prev-audio');
            const nextBtn = document.getElementById('new-release-next-audio');
            const navInfo = document.getElementById('new-release-audio-nav-info');
            
            if (!AudioContainerManager.navContainer) return;
            
            // Show navigation elements
            if (AudioContainerManager.navDivider) AudioContainerManager.navDivider.style.display = 'block';
            AudioContainerManager.navContainer.style.display = 'flex';
            
            // Setup event listeners
            if (prevBtn) {
                prevBtn.onclick = () => previousNewReleaseAudio();
            }
            
            if (nextBtn) {
                nextBtn.onclick = () => nextNewReleaseAudio();
            }
            
            // Update initial state
            updateNewReleaseAudioNavigationState();
        }

        function hideNewReleaseAudioNavigation() {
            if (AudioContainerManager.navDivider) AudioContainerManager.navDivider.style.display = 'none';
            if (AudioContainerManager.navContainer) AudioContainerManager.navContainer.style.display = 'none';
        }

        function switchToNewReleaseAudio(index) {
            if (index < 0 || index >= newReleaseAudioFiles.length) return;
            
            if (!AudioContainerManager.playersContainer) return;
            
            const allPlayers = AudioContainerManager.playersContainer.querySelectorAll('.new-release-audio-player');
            
            // Hide current player
            if (allPlayers[currentNewReleaseAudioIndex]) {
                allPlayers[currentNewReleaseAudioIndex].style.display = 'none';
                const currentAudio = allPlayers[currentNewReleaseAudioIndex].querySelector('audio');
                if (currentAudio && !currentAudio.paused) {
                    currentAudio.pause();
                }
            }
            
            // Show new player
            currentNewReleaseAudioIndex = index;
            if (allPlayers[currentNewReleaseAudioIndex]) {
                allPlayers[currentNewReleaseAudioIndex].style.display = 'block';
            }
            
            updateNewReleaseAudioNavigationState();
        }

        function previousNewReleaseAudio() {
            if (currentNewReleaseAudioIndex > 0) {
                switchToNewReleaseAudio(currentNewReleaseAudioIndex - 1);
            }
        }

        function nextNewReleaseAudio() {
            if (currentNewReleaseAudioIndex < newReleaseAudioFiles.length - 1) {
                switchToNewReleaseAudio(currentNewReleaseAudioIndex + 1);
            }
        }

        function updateNewReleaseAudioNavigationState() {
            const prevBtn = document.getElementById('new-release-prev-audio');
            const nextBtn = document.getElementById('new-release-next-audio');
            const navInfo = document.getElementById('new-release-audio-nav-info');
            
            if (prevBtn) {
                prevBtn.disabled = currentNewReleaseAudioIndex === 0;
            }
            
            if (nextBtn) {
                nextBtn.disabled = currentNewReleaseAudioIndex === newReleaseAudioFiles.length - 1;
            }
            
            if (navInfo) {
                navInfo.textContent = `Movement ${currentNewReleaseAudioIndex + 1} of ${newReleaseAudioFiles.length}`;
            }
        }



        function removeNewReleaseLoadingState() {
            if (AudioContainerManager.playersContainer) {
                const loadingElement = AudioContainerManager.playersContainer.querySelector('.audio-loading');
                if (loadingElement) {
                    loadingElement.remove();
                }
            }
        }

        function extractMovementTitle(title) {
            if (!title) return '';
            
            const dashMatch = title.match(/^.+?\s*-\s*(.+)$/);
            if (dashMatch && dashMatch[1]) {
                return dashMatch[1].trim();
            }
            
            return title;
        }

        function startNewReleaseAutoCycle() {
            const autoCycleCheckbox = document.getElementById('new-release-auto-cycle');
            if (!autoCycleCheckbox || !autoCycleCheckbox.checked) return;
            
            // Clear any existing interval first
            if (newReleaseAutoCycleInterval) {
                clearInterval(newReleaseAutoCycleInterval);
            }
            
            // Hide paused status
            const statusElement = document.getElementById('auto-cycle-status');
            if (statusElement) {
                statusElement.style.display = 'none';
            }
            
            console.log('🔄 Starting new release auto-cycle (12 seconds)');
            
            newReleaseAutoCycleInterval = setInterval(() => {
                console.log('🔄 Auto-cycle triggered - moving to next composition');
                if (currentNewReleaseIndex < newReleaseCompositions.length - 1) {
                    nextNewRelease();
                } else {
                    // Loop back to first with animation
                    currentNewReleaseIndex = 0;
                    nextNewRelease(); // Use the same function for consistent animation
                }
            }, 12000); // 12 seconds
        }

        function stopNewReleaseAutoCycle() {
            if (newReleaseAutoCycleInterval) {
                clearInterval(newReleaseAutoCycleInterval);
                newReleaseAutoCycleInterval = null;
            }
            
            // Show paused status if audio is playing
            const statusElement = document.getElementById('auto-cycle-status');
            const isAudioVisible = AudioContainerManager.container && 
                AudioContainerManager.container.classList.contains('has-audio');
            
            if (statusElement && isAudioVisible) {
                statusElement.style.display = 'inline';
            }
        }

        function resetNewReleaseAutoCycle() {
            console.log('🔄 Resetting new release auto-cycle timer to 12 seconds');
            stopNewReleaseAutoCycle();
            startNewReleaseAutoCycle();
        }

        // Featured Audio Player Functions
        function playFeaturedComposition() {
            const listenBtn = document.getElementById('listen-btn');
            
            // Check if audio container is currently visible
            const isVisible = AudioContainerManager.container && 
                AudioContainerManager.container.classList.contains('has-audio');
            
            if (!isVisible) {
                // Stop auto-scrolling when showing audio
                stopNewReleaseAutoCycle();
                
                // Show the audio container using the manager
                AudioContainerManager.show();
                
                // Update listen button text and state
                if (listenBtn) {
                    listenBtn.innerHTML = '<span class="status-circle"></span>Listen (In View)';
                    listenBtn.classList.add('in-view');
                }
                
                // Show auto-cycle paused status
                const statusElement = document.getElementById('auto-cycle-status');
                if (statusElement) {
                    statusElement.style.display = 'inline';
                }
                
                // Ensure audio player is synced with current composition
                updateNewReleaseAudioPlayer();
                
                console.log('🎵 Audio container shown for composition:', newReleaseCompositions[currentNewReleaseIndex]?.title);
            } else {
                // Hide the audio container using the manager
                AudioContainerManager.hide();
                
                // Update listen button text and state
                if (listenBtn) {
                    listenBtn.innerHTML = '<span class="status-circle"></span>Listen (Hidden)';
                    listenBtn.classList.remove('in-view');
                }
                
                // Pause all audio players when hiding
                const allPlayers = document.querySelectorAll('#new-release-audio-players .new-release-audio-player audio');
                allPlayers.forEach(audio => {
                    if (!audio.paused) {
                        audio.pause();
                        audio.currentTime = 0;
                    }
                });
                
                // Restart auto-scrolling when hiding audio (reset timer to 12 seconds)
                resetNewReleaseAutoCycle();
                
                console.log('🎵 Audio container hidden - auto-cycle reset to 12 seconds');
            }
        }

        function viewFeaturedScore() {
            console.log('🎯 viewFeaturedScore function called!');
            const viewScoreBtn = document.getElementById('view-score-btn');
            const scoreSection = document.getElementById('new-release-score-section');
            
            console.log('🔍 Debug elements:', {
                viewScoreBtn: !!viewScoreBtn,
                scoreSection: !!scoreSection,
                viewScoreBtnId: viewScoreBtn?.id,
                scoreSectionId: scoreSection?.id
            });
            
            if (!viewScoreBtn || !scoreSection) {
                console.error('❌ View Score button or score section not found');
                return;
            }
            
            if (viewScoreBtn.classList.contains('in-view')) {
                // Hide score section
                scoreSection.style.display = 'none';
                viewScoreBtn.innerHTML = '<span class="status-circle"></span>View Score (Hidden)';
                viewScoreBtn.classList.remove('in-view');
                console.log('📄 Score section hidden');
            } else {
                // Show score section and STOP auto-scroll
                scoreSection.style.display = 'block';
                viewScoreBtn.innerHTML = '<span class="status-circle"></span>View Score (View)';
                viewScoreBtn.classList.add('in-view');
                
                // ✨ STOP AUTO-SCROLL when View Score is opened
                stopNewReleaseAutoCycle();
                console.log('🔄 Auto-scroll stopped - user is viewing score');
                
                // Initialize score layout if not already done
                if (!window.newReleaseScoreLayoutManager) {
                    initializeNewReleaseScoreLayout();
                } else {
                    // Update score data for current composition
                    const currentComposition = newReleaseCompositions[currentNewReleaseIndex];
                    if (currentComposition) {
                        loadNewReleaseScoreData(currentComposition);
                    }
                }
                
                console.log('📄 Score section shown');
            }
        }

        function initializeNewReleaseScoreLayout() {
            console.log('🎯 Initializing New Release Score Layout...');
            
            // Create a new instance of ScoreLayoutManager for new releases
            window.newReleaseScoreLayoutManager = new ScoreLayoutManager();
            window.newReleaseScoreLayoutManager.init();
            
            // Set up the score layout with the current composition's data
            const currentComposition = newReleaseCompositions[currentNewReleaseIndex];
            if (currentComposition) {
                loadNewReleaseScoreData(currentComposition);
                
                // After loading data, set the default state based on content availability
                setTimeout(() => {
                    const hasPdf = (currentComposition.scoreFiles && currentComposition.scoreFiles.length > 0) || currentComposition.scoreLink;
                    const hasScoreVideos = (currentComposition.videoFiles && currentComposition.videoFiles.filter(video => video.type === 'Score Video').length > 0);
                    
                    console.log('🎯 Setting default score layout state:', { hasPdf, hasScoreVideos });
                    
                    if (hasScoreVideos) {
                        // ✨ DEFAULT: Score Video in view, PDF hidden
                        window.newReleaseScoreLayoutManager.setState('VIDEO_ONLY');
                        console.log('🎯 Default state set to VIDEO_ONLY (score video in view, PDF hidden)');
                    } else if (hasPdf) {
                        // Fallback: PDF in view if no score videos
                        window.newReleaseScoreLayoutManager.setState('PDF_ONLY');
                        console.log('🎯 Default state set to PDF_ONLY (PDF in view, no score videos)');
                    } else {
                        // No score content available
                        window.newReleaseScoreLayoutManager.setState('HIDDEN');
                        console.log('🎯 Default state set to HIDDEN (no score content)');
                    }
                }, 100);
            }
        }

        function loadNewReleaseScoreData(composition) {
            console.log('📄 Loading score data for:', composition.title);
            
            // Clear existing content first
            const pdfContainer = document.getElementById('score-carousel-container');
            const videoContainer = document.getElementById('score-video-content');
            
            if (pdfContainer) {
                pdfContainer.innerHTML = '';
                pdfContainer.classList.remove('show');
            }
            
            if (videoContainer) {
                videoContainer.innerHTML = '';
            }
            
            // Load PDF score if available
            if (composition.scoreLink) {
                loadNewReleaseScorePDF(composition.scoreLink);
            }
            
            // Load score videos from videoFiles array (filtered by type)
            const scoreVideos = (composition.videoFiles || []).filter(video => video.type === 'Score Video');
            if (scoreVideos.length > 0) {
                loadNewReleaseScoreVideos(scoreVideos);
            }
            
            console.log('📄 Score data loaded:', {
                hasPdf: !!composition.scoreLink,
                hasVideos: scoreVideos.length > 0,
                scoreLink: composition.scoreLink,
                scoreVideos: scoreVideos.length,
                videoFiles: composition.videoFiles?.length || 0,
                scoreVideosFromFilter: scoreVideos
            });
        }

        function loadNewReleaseScorePDF(pdfUrl) {
            const pdfContainer = document.getElementById('score-carousel-container');
            if (!pdfContainer) return;
            
            pdfContainer.innerHTML = `
                <div class="single-page-score-viewer">
                    <div class="score-container">
                        <div class="score-iframe-container">
                            <iframe 
                                id="new-release-score-iframe"
                                src="/pdfjs/web/viewer.html?file=${encodeURIComponent(pdfUrl)}#page=1&zoom=page-fit&toolbar=0&navpanes=0&spreadModeOnLoad=0&scrollModeOnLoad=1"
                                width="100%"
                                height="700px"
                                style="border: none; border-radius: 8px;">
                            </iframe>
                        </div>
                        <div class="score-navigation-bottom">
                            <button class="score-nav-btn prev-btn" id="new-release-score-prev">
                                <span class="nav-icon">←</span>
                                <span class="nav-text">Previous Page</span>
                            </button>
                            <span class="score-page-info" id="new-release-score-page-info">Page 1 of ?</span>
                            <button class="score-nav-btn next-btn" id="new-release-score-next">
                                <span class="nav-text">Next Page</span>
                                <span class="nav-icon">→</span>
                            </button>
                        </div>
                    </div>
                </div>
            `;
            pdfContainer.classList.add('show');
            
            // Initialize single-page PDF navigation
            initNewReleaseSinglePagePDFNavigation(pdfUrl);
            console.log('📄 PDF score loaded with navigation:', pdfUrl);
        }

        function loadNewReleaseScoreVideos(videos) {
            const videoContainer = document.getElementById('score-video-content');
            if (!videoContainer) return;
            
            console.log('🎥 DEBUG - Loading score videos:', videos.length, videos);
            
            const videoHtml = videos.map((video, index) => {
                console.log(`🎥 DEBUG - Processing score video ${index + 1}:`, video);
                
                // Validate video data
                if (!video.url) {
                    console.error(`🎥 ERROR - Score video ${index + 1} has no URL:`, video);
                    return `
                        <div class="composition-score-video-player">
                            <div class="score-video-content">
                                <div class="video-error">Score video URL not available</div>
                            </div>
                        </div>
                    `;
                }
                
                const videoPlayerHtml = createVideoPlayer(video.url, video.title);
                console.log(`🎥 DEBUG - Generated video player HTML length:`, videoPlayerHtml?.length || 0);
                
                // Validate generated HTML
                if (!videoPlayerHtml || videoPlayerHtml.trim() === '') {
                    console.error(`🎥 ERROR - Failed to generate video player HTML for:`, video);
                    return `
                        <div class="composition-score-video-player">
                            <div class="score-video-content">
                                <div class="video-error">Failed to create video player</div>
                            </div>
                        </div>
                    `;
                }
                
                const metadataHtml = video.performanceBy ? `
                    <div class="score-video-metadata">
                        <div class="performance-info">Performed by: ${video.performanceBy}</div>
                    </div>
                ` : '';

                return `
                    <div class="composition-score-video-player" style="${index === 0 ? 'display: block;' : 'display: none;'}">
                        <div class="score-video-content">
                            ${videoPlayerHtml}
                        </div>
                        ${metadataHtml ? `<div class="score-video-metadata-section">${metadataHtml}</div>` : ''}
                    </div>
                `;
            }).join('');
            
            videoContainer.innerHTML = videoHtml;
            console.log('🎥 DEBUG - Score videos loaded successfully:', videos.length);
        }

        function toggleNewReleaseScorePDF() {
            if (window.newReleaseScoreLayoutManager) {
                window.newReleaseScoreLayoutManager.togglePdf();
            } else {
                console.error('NewReleaseScoreLayoutManager not initialized');
            }
        }

        function toggleNewReleaseScoreVideo() {
            if (window.newReleaseScoreLayoutManager) {
                window.newReleaseScoreLayoutManager.toggleVideo();
            } else {
                console.error('NewReleaseScoreLayoutManager not initialized');
            }
        }

        function getYouTubeVideoId(url) {
            if (!url) return null;
            
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        function isYouTubeUrl(url) {
            return url && (url.includes('youtube.com') || url.includes('youtu.be'));
        }

        function createYouTubeEmbed(url, title = 'Video') {
            const videoId = getYouTubeVideoId(url);
            if (!videoId) {
                console.warn('Invalid YouTube URL:', url);
                return null;
            }
            
            return `
                <div class="youtube-embed-container">
                    <iframe src="https://www.youtube.com/embed/${videoId}" 
                            frameborder="0" 
                            allowfullscreen
                            title="${title}">
                    </iframe>
                </div>
            `;
        }

        function createVideoPlayer(url, title = 'Video') {
            if (!url) {
                console.warn('No URL provided for video player');
                return '<div class="video-error">Video URL not available</div>';
            }
            
            console.log('🎥 DEBUG - Creating video player for URL:', url);
            
            // Check if this is a YouTube video
            const isYouTube = isYouTubeUrl(url);
            console.log('🎥 DEBUG - Is YouTube URL:', isYouTube);
            
            if (isYouTube) {
                // Use YouTube embed for YouTube URLs
                const youtubeEmbed = createYouTubeEmbed(url, title);
                if (youtubeEmbed) {
                    console.log('🎥 DEBUG - YouTube embed created successfully');
                    return youtubeEmbed;
                } else {
                    console.warn('🎥 DEBUG - Failed to create YouTube embed, falling back to direct video');
                    // Fall back to direct video if YouTube embed fails
                    return `
                        <video controls preload="metadata" style="width: 100%; height: auto;">
                            <source src="${url}" type="video/mp4">
                            Your browser does not support the video element.
                        </video>
                    `;
                }
            } else {
                // Use standard video element for direct video files
                console.log('🎥 DEBUG - Creating standard video element');
                return `
                    <video controls preload="metadata" style="width: 100%; height: auto;">
                        <source src="${url}" type="video/mp4">
                        <source src="${url}" type="video/webm">
                        <source src="${url}" type="video/ogg">
                        Your browser does not support the video element.
                    </video>
                `;
            }
        }

        // ===== NEW RELEASE PDF NAVIGATION FUNCTIONS =====
        let newReleaseScoreIframe = null;
        let newReleaseCurrentPage = 1;
        let newReleaseTotalPages = 1;

        function initNewReleaseSinglePagePDFNavigation(pdfUrl) {
            console.log('🔄 Initializing new release single-page PDF navigation for:', pdfUrl);
            
            newReleaseScoreIframe = document.getElementById('new-release-score-iframe');
            
            if (!newReleaseScoreIframe) {
                console.error('❌ New release score iframe not found');
                return;
            }
            
            // Wait for iframe to load, then get total pages
            newReleaseScoreIframe.addEventListener('load', () => {
                console.log('✅ New release PDF iframe loaded');
                
                // Try to get page count from PDF.js viewer
                setTimeout(() => {
                    try {
                        const iframeWindow = newReleaseScoreIframe.contentWindow;
                        if (iframeWindow && iframeWindow.PDFViewerApplication) {
                            newReleaseTotalPages = iframeWindow.PDFViewerApplication.pagesCount;
                            console.log(`📄 New release total pages: ${newReleaseTotalPages}`);
                            updateNewReleasePageInfo();
                            updateNewReleaseNavigationButtons();
                        } else {
                            // Fallback: estimate based on PDF or just enable navigation
                            console.log('⚠️ Could not get page count, enabling navigation anyway');
                            newReleaseTotalPages = 999; // Large number to allow navigation
                            updateNewReleasePageInfo();
                            updateNewReleaseNavigationButtons();
                        }
                    } catch (error) {
                        console.log('⚠️ Cannot access iframe content, enabling navigation anyway');
                        newReleaseTotalPages = 999;
                        updateNewReleasePageInfo();
                        updateNewReleaseNavigationButtons();
                    }
                }, 1000);
            });
            
            // Set up single-page navigation buttons
            setupNewReleaseSinglePageNavigation();
        }

        function setupNewReleaseSinglePageNavigation() {
            const prevBtn = document.getElementById('new-release-score-prev');
            const nextBtn = document.getElementById('new-release-score-next');
            
            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    if (newReleaseCurrentPage > 1) {
                        goToNewReleasePage(newReleaseCurrentPage - 1);
                    }
                });
            }
            
            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    if (newReleaseCurrentPage < newReleaseTotalPages) {
                        goToNewReleasePage(newReleaseCurrentPage + 1);
                    }
                });
            }
            
            // Add keyboard support
            document.addEventListener('keydown', (e) => {
                if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                    if (e.key === 'ArrowLeft' && newReleaseCurrentPage > 1) {
                        e.preventDefault();
                        goToNewReleasePage(newReleaseCurrentPage - 1);
                    } else if (e.key === 'ArrowRight' && newReleaseCurrentPage < newReleaseTotalPages) {
                        e.preventDefault();
                        goToNewReleasePage(newReleaseCurrentPage + 1);
                    }
                }
            });
        }

        function goToNewReleasePage(pageNumber) {
            if (pageNumber < 1 || (newReleaseTotalPages !== 999 && pageNumber > newReleaseTotalPages)) {
                return;
            }
            
            newReleaseCurrentPage = pageNumber;
            
            // Update iframe src with new page
            const baseUrl = newReleaseScoreIframe.src.split('#')[0];
            newReleaseScoreIframe.src = `${baseUrl}#page=${pageNumber}&zoom=page-fit&toolbar=0&navpanes=0&spreadModeOnLoad=0&scrollModeOnLoad=1`;
            
            updateNewReleasePageInfo();
            updateNewReleaseNavigationButtons();
            
            console.log(`📄 New release navigated to page ${pageNumber}`);
        }

        function updateNewReleasePageInfo() {
            const pageInfo = document.getElementById('new-release-score-page-info');
            if (pageInfo) {
                pageInfo.textContent = `Page ${newReleaseCurrentPage} of ${newReleaseTotalPages === 999 ? '?' : newReleaseTotalPages}`;
            }
        }

        function updateNewReleaseNavigationButtons() {
            const prevBtn = document.getElementById('new-release-score-prev');
            const nextBtn = document.getElementById('new-release-score-next');
            
            if (prevBtn) {
                prevBtn.disabled = newReleaseCurrentPage <= 1;
                prevBtn.style.opacity = newReleaseCurrentPage <= 1 ? '0.5' : '1';
            }
            
            if (nextBtn) {
                nextBtn.disabled = newReleaseCurrentPage >= newReleaseTotalPages;
                nextBtn.style.opacity = newReleaseCurrentPage >= newReleaseTotalPages ? '0.5' : '1';
            }
        }

        function playCarouselComposition(index) {
            const audioContainer = document.getElementById('new-release-audio-container');
            const audioPlayer = document.getElementById('new-release-audio-player');
            const audioTitle = document.querySelector('#new-release-audio-container .audio-composition-title');
            const audioInstrumentation = document.querySelector('#new-release-audio-container .audio-composition-instrumentation');
            const audioCover = document.querySelector('#new-release-audio-container .audio-cover');
            const listenBtn = document.getElementById(`carousel-listen-${index}`);
            
            // Show the audio container
            audioContainer.style.display = 'block';
            
            // Update listen button text
            if (listenBtn) {
                listenBtn.innerHTML = '<span class="btn-icon">🎵</span>Listen (In View)';
            }
            
            // Get the composition from the carousel
            if (compositionsCarousel[index]) {
                const composition = compositionsCarousel[index];
                
                // Update audio player content
                audioTitle.textContent = composition.title || 'Composition';
                audioInstrumentation.textContent = composition.instrumentation || 'Brass Ensemble';
                
                if (composition.coverImage) {
                    audioCover.src = composition.coverImage;
                }
                
                if (composition.audioPreview) {
                    audioPlayer.src = composition.audioPreview;
                    audioPlayer.load();
                    audioPlayer.play();
                }
            }
        }

        function learnMoreComposition() {
            // Navigate to the specific composition page
            if (newReleaseCompositions && newReleaseCompositions[currentNewReleaseIndex]) {
                const composition = newReleaseCompositions[currentNewReleaseIndex];
                const slug = composition.slug || composition.title?.toLowerCase().replace(/[^a-z0-9]+/g, '-');
                if (slug) {
                    window.location.href = `/composition.html?slug=${slug}`;
                } else {
                    // Fallback to music catalog if no slug available
                    window.location.href = '/music-catalog.html';
                }
            } else {
                // Fallback to music catalog if no composition data
                window.location.href = '/music-catalog.html';
            }
        }

        function viewScoreComposition() {
            // Navigate to the music catalog page
            window.location.href = '/music-catalog.html';
        }

        function buyNowComposition() {
            // Use the existing purchase function for Stripe integration
            if (newReleaseCompositions && newReleaseCompositions[currentNewReleaseIndex]) {
                const composition = newReleaseCompositions[currentNewReleaseIndex];
                if (composition.paymentLink) {
                    // Use the existing purchaseComposition function with confirmation dialog
                    purchaseComposition(composition.paymentLink, composition.title);
                    console.log('💳 Processing purchase for:', composition.title);
                } else {
                    // Fallback to music catalog if no payment link
                    console.log('⚠️ No payment link available for:', composition.title);
                    window.location.href = '/music-catalog.html';
                }
            } else {
                // Fallback to music catalog if no composition data
                window.location.href = '/music-catalog.html';
            }
        }

        // Load everything when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Audio Container Manager first
            AudioContainerManager.init();
            
            loadFeaturedCompositions(); // Load the enhanced featured compositions system
            loadFeaturedComposition();
            loadCompositionsCarousel(); // Load the new compositions carousel
            loadNewCatalogRelease(); // Load the new catalog release
            initHeroVideo(); // This will handle fallback to carousel internally
            initHeroRotation();
            
            // Auto-cycle toggle event listener
            const autoCycleCheckbox = document.getElementById('new-release-auto-cycle');
            if (autoCycleCheckbox) {
                autoCycleCheckbox.addEventListener('change', function() {
                    if (this.checked) {
                        startNewReleaseAutoCycle();
                    } else {
                        stopNewReleaseAutoCycle();
                    }
                });
            }
            
            // Mobile menu and theme toggle are now handled by main.js
        });
        
        // Clean up any existing timeouts on page unload
        window.addEventListener('beforeunload', function() {
            if (videoRetryTimeout) {
                clearTimeout(videoRetryTimeout);
            }
        });
    </script>
    
    <!-- Load external script for additional functionality -->
    <script src="/score-layout-manager.js"></script>
    <script src="composition.js"></script>
    <script src="main.js"></script>
    
    </div> <!-- Close main-content-container -->
</body>
</html>